<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Verbs Part 3: mutate | R Study Guide for Cronkite School of Journalism</title>
  <meta name="description" content="A companion book for the Cronkite School’s data journalism class for graduate students. A work in progress." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Verbs Part 3: mutate | R Study Guide for Cronkite School of Journalism" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://cronkitedata.github.io/rstudyguide" />
  
  <meta property="og:description" content="A companion book for the Cronkite School’s data journalism class for graduate students. A work in progress." />
  <meta name="github-repo" content="cronkitedata/rstudyguide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Verbs Part 3: mutate | R Study Guide for Cronkite School of Journalism" />
  
  <meta name="twitter:description" content="A companion book for the Cronkite School’s data journalism class for graduate students. A work in progress." />
  

<meta name="author" content="Sarah Cohen, Knight Chair in Journalism" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.io" type="image/x-icon" />
<link rel="prev" href="033-groupby.html"/>
<link rel="next" href="036-joins.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="mystyles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Study Guide for Cronkite Students</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-the-examples-with-packages"><i class="fa fa-check"></i>Using the examples with packages</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to R for Journalists</b></span></li>
<li class="chapter" data-level="1" data-path="011-r-install.html"><a href="011-r-install.html"><i class="fa fa-check"></i><b>1</b> An R and R Studio tour</a>
<ul>
<li class="chapter" data-level="1.1" data-path="011-r-install.html"><a href="011-r-install.html#key-takeaways"><i class="fa fa-check"></i><b>1.1</b> Key takeaways</a></li>
<li class="chapter" data-level="1.2" data-path="011-r-install.html"><a href="011-r-install.html#why-program"><i class="fa fa-check"></i><b>1.2</b> Why program?</a></li>
<li class="chapter" data-level="1.3" data-path="011-r-install.html"><a href="011-r-install.html#setting-up-r-and-r-studio"><i class="fa fa-check"></i><b>1.3</b> Setting up R and R Studio</a></li>
<li class="chapter" data-level="1.4" data-path="011-r-install.html"><a href="011-r-install.html#an-r-studio-tour"><i class="fa fa-check"></i><b>1.4</b> An R Studio tour</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="011-r-install.html"><a href="011-r-install.html#the-console"><i class="fa fa-check"></i><b>1.4.1</b> The Console</a></li>
<li class="chapter" data-level="1.4.2" data-path="011-r-install.html"><a href="011-r-install.html#work-in-projects"><i class="fa fa-check"></i><b>1.4.2</b> Work in projects</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="011-r-install.html"><a href="011-r-install.html#unlocking-packages"><i class="fa fa-check"></i><b>1.5</b> Unlocking packages</a></li>
<li class="chapter" data-level="1.6" data-path="011-r-install.html"><a href="011-r-install.html#variables"><i class="fa fa-check"></i><b>1.6</b> Variables</a></li>
<li class="chapter" data-level="1.7" data-path="011-r-install.html"><a href="011-r-install.html#resources-and-exercises"><i class="fa fa-check"></i><b>1.7</b> Resources and exercises</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="011-r-install.html"><a href="011-r-install.html#googling-for-help"><i class="fa fa-check"></i><b>1.7.1</b> Googling for help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="021-r-markdown.html"><a href="021-r-markdown.html"><i class="fa fa-check"></i><b>2</b> R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="021-r-markdown.html"><a href="021-r-markdown.html#key-takeaways-1"><i class="fa fa-check"></i><b>2.1</b> Key takeaways</a></li>
<li class="chapter" data-level="2.2" data-path="021-r-markdown.html"><a href="021-r-markdown.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>2.2</b> Getting started with R Markdown</a></li>
<li class="chapter" data-level="2.3" data-path="021-r-markdown.html"><a href="021-r-markdown.html#the-anatomy-of-a-document"><i class="fa fa-check"></i><b>2.3</b> The anatomy of a document</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="021-r-markdown.html"><a href="021-r-markdown.html#writing-in-markdown"><i class="fa fa-check"></i><b>2.3.1</b> Writing in markdown</a></li>
<li class="chapter" data-level="" data-path="021-r-markdown.html"><a href="021-r-markdown.html#front-matter-yaml-at-the-top"><i class="fa fa-check"></i>Front matter / YAML at the top</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="021-r-markdown.html"><a href="021-r-markdown.html#knitting-your-document"><i class="fa fa-check"></i><b>2.4</b> Knitting your document</a></li>
<li class="chapter" data-level="2.5" data-path="021-r-markdown.html"><a href="021-r-markdown.html#including-r-code-and-its-results"><i class="fa fa-check"></i><b>2.5</b> Including R code and its results</a></li>
<li class="chapter" data-level="2.6" data-path="021-r-markdown.html"><a href="021-r-markdown.html#r-markdown-starts-from-scratch"><i class="fa fa-check"></i><b>2.6</b> R Markdown starts from scratch</a></li>
<li class="chapter" data-level="2.7" data-path="021-r-markdown.html"><a href="021-r-markdown.html#rmarkdown-resources-and-exercises"><i class="fa fa-check"></i><b>2.7</b> RMarkdown resources and exercises</a>
<ul>
<li class="chapter" data-level="" data-path="021-r-markdown.html"><a href="021-r-markdown.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="021-r-markdown.html"><a href="021-r-markdown.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="021-r-markdown.html"><a href="021-r-markdown.html#bonus-styling-your-r-markdown-documents"><i class="fa fa-check"></i><b>2.8</b> Bonus: Styling your R Markdown documents</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="022-data-frames.html"><a href="022-data-frames.html"><i class="fa fa-check"></i><b>3</b> Data frames and the tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="022-data-frames.html"><a href="022-data-frames.html#key-takeaways-2"><i class="fa fa-check"></i><b>3.1</b> Key takeaways</a></li>
<li class="chapter" data-level="3.2" data-path="022-data-frames.html"><a href="022-data-frames.html#getting-started"><i class="fa fa-check"></i><b>3.2</b> Getting started</a></li>
<li class="chapter" data-level="3.3" data-path="022-data-frames.html"><a href="022-data-frames.html#the-data-frame"><i class="fa fa-check"></i><b>3.3</b> The data frame</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="022-data-frames.html"><a href="022-data-frames.html#loading-and-looking-at-data"><i class="fa fa-check"></i><b>3.3.1</b> Loading and looking at data</a></li>
<li class="chapter" data-level="3.3.2" data-path="022-data-frames.html"><a href="022-data-frames.html#examine-your-data"><i class="fa fa-check"></i><b>3.3.2</b> Examine your data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="022-data-frames.html"><a href="022-data-frames.html#introducing-the-pipe"><i class="fa fa-check"></i><b>3.4</b> Introducing the pipe</a></li>
<li class="chapter" data-level="3.5" data-path="022-data-frames.html"><a href="022-data-frames.html#take-a-break"><i class="fa fa-check"></i><b>3.5</b> Take a break</a></li>
<li class="chapter" data-level="3.6" data-path="022-data-frames.html"><a href="022-data-frames.html#data-frames-resources"><i class="fa fa-check"></i><b>3.6</b> Data frames resources</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="022-data-frames.html"><a href="022-data-frames.html#on-your-own"><i class="fa fa-check"></i><b>3.6.1</b> On your own</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II The Verbs of the Tidyverse</b></span></li>
<li class="chapter" data-level="4" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html"><i class="fa fa-check"></i><b>4</b> A quick tour of verbs</a>
<ul>
<li class="chapter" data-level="4.1" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#key-takeaways-3"><i class="fa fa-check"></i><b>4.1</b> Key takeaways</a>
<ul>
<li class="chapter" data-level="" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#data-for-this-walkthrough"><i class="fa fa-check"></i>Data for this walkthrough</a></li>
<li class="chapter" data-level="4.1.1" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#follow-along"><i class="fa fa-check"></i><b>4.1.1</b> Follow along</a></li>
<li><a href="030-intro-verbs.html#the-operator-and-then">The <code>%&gt;%</code> operator: … and then…</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#looking-at-your-data-in-pieces-and-in-order"><i class="fa fa-check"></i><b>4.2</b> Looking at your data in pieces and in order</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#select-to-pick-out-columns"><i class="fa fa-check"></i><b>4.2.1</b> <code>select</code> to pick out columns</a></li>
<li class="chapter" data-level="4.2.2" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#arrange-to-sort"><i class="fa fa-check"></i><b>4.2.2</b> <code>arrange</code> to sort</a></li>
<li class="chapter" data-level="4.2.3" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#filter-to-pick-out-rows"><i class="fa fa-check"></i><b>4.2.3</b> <code>filter</code> to pick out rows</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#group_by-and-summarise-to-count-and-sum"><i class="fa fa-check"></i><b>4.3</b> <code>group_by</code> and <code>summarise</code> to count and sum</a></li>
<li class="chapter" data-level="4.4" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#mutate-to-calculate-something-new"><i class="fa fa-check"></i><b>4.4</b> <code>mutate</code> to calculate something new</a></li>
<li class="chapter" data-level="4.5" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#join-to-merge-tables-together-by-column-union-to-add-rows"><i class="fa fa-check"></i><b>4.5</b> <code>join</code> to merge tables together by column; <code>union</code> to add rows</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="031-select-filter.html"><a href="031-select-filter.html"><i class="fa fa-check"></i><b>5</b> Verbs Part 1: Picking and choosing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="031-select-filter.html"><a href="031-select-filter.html#key-takeaways-4"><i class="fa fa-check"></i><b>5.1</b> Key takeaways</a></li>
<li class="chapter" data-level="5.2" data-path="031-select-filter.html"><a href="031-select-filter.html#select---choosing-columns"><i class="fa fa-check"></i><b>5.2</b> Select - choosing columns</a>
<ul>
<li class="chapter" data-level="" data-path="031-select-filter.html"><a href="031-select-filter.html#selecting-with-shortcuts"><i class="fa fa-check"></i>Selecting with shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="031-select-filter.html"><a href="031-select-filter.html#filter---choosing-rows"><i class="fa fa-check"></i><b>5.3</b> Filter - choosing rows</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="031-select-filter.html"><a href="031-select-filter.html#one-filter"><i class="fa fa-check"></i><b>5.3.1</b> One filter</a></li>
<li class="chapter" data-level="5.3.2" data-path="031-select-filter.html"><a href="031-select-filter.html#a-compound-filter"><i class="fa fa-check"></i><b>5.3.2</b> A compound filter</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="031-select-filter.html"><a href="031-select-filter.html#arrange---change-the-order"><i class="fa fa-check"></i><b>5.4</b> Arrange - change the order</a></li>
<li class="chapter" data-level="5.5" data-path="031-select-filter.html"><a href="031-select-filter.html#troubleshooting"><i class="fa fa-check"></i><b>5.5</b> Troubleshooting</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="031-select-filter.html"><a href="031-select-filter.html#variable-not-found"><i class="fa fa-check"></i><b>5.5.1</b> Variable not found</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="031-select-filter.html"><a href="031-select-filter.html#sort-filter-resources"><i class="fa fa-check"></i><b>5.6</b> Sort / filter resources</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="031-select-filter.html"><a href="031-select-filter.html#exercises-1"><i class="fa fa-check"></i><b>5.6.1</b> Exercises</a></li>
<li class="chapter" data-level="5.6.2" data-path="031-select-filter.html"><a href="031-select-filter.html#tutorials"><i class="fa fa-check"></i><b>5.6.2</b> Tutorials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="033-groupby.html"><a href="033-groupby.html"><i class="fa fa-check"></i><b>6</b> Verbs Part 2: group_by and summarise</a>
<ul>
<li class="chapter" data-level="6.1" data-path="033-groupby.html"><a href="033-groupby.html#key-takeaways-5"><i class="fa fa-check"></i><b>6.1</b> Key takeaways</a></li>
<li class="chapter" data-level="6.2" data-path="033-groupby.html"><a href="033-groupby.html#group_by-summarise-basics"><i class="fa fa-check"></i><b>6.2</b> group_by / summarise basics</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="033-groupby.html"><a href="033-groupby.html#other-summary-functions"><i class="fa fa-check"></i><b>6.2.1</b> Other summary functions</a></li>
<li class="chapter" data-level="6.2.2" data-path="033-groupby.html"><a href="033-groupby.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>6.2.2</b> Grouping by more than one variable</a></li>
<li class="chapter" data-level="6.2.3" data-path="033-groupby.html"><a href="033-groupby.html#rolling-up-to-the-next-level"><i class="fa fa-check"></i><b>6.2.3</b> Rolling up to the next level</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="033-groupby.html"><a href="033-groupby.html#restructuring-for-a-report-with-pivot_wider"><i class="fa fa-check"></i><b>6.3</b> Restructuring for a report with <code>pivot_wider()</code></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="033-groupby.html"><a href="033-groupby.html#a-note-on-restructuring-your-data-frames"><i class="fa fa-check"></i><b>6.3.1</b> A note on restructuring your data frames</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="033-groupby.html"><a href="033-groupby.html#resources-exercises"><i class="fa fa-check"></i><b>6.4</b> Resources &amp; exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="033-groupby.html"><a href="033-groupby.html#exercises-2"><i class="fa fa-check"></i><b>6.4.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="035-mutate.html"><a href="035-mutate.html"><i class="fa fa-check"></i><b>7</b> Verbs Part 3: mutate</a>
<ul>
<li class="chapter" data-level="7.1" data-path="035-mutate.html"><a href="035-mutate.html#key-takeaways-6"><i class="fa fa-check"></i><b>7.1</b> Key takeaways</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="035-mutate.html"><a href="035-mutate.html#read-in-some-data"><i class="fa fa-check"></i><b>7.1.1</b> Read in some data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="035-mutate.html"><a href="035-mutate.html#simple-arithmetic"><i class="fa fa-check"></i><b>7.2</b> Simple arithmetic</a></li>
<li class="chapter" data-level="7.3" data-path="035-mutate.html"><a href="035-mutate.html#creating-categories-with-if_else"><i class="fa fa-check"></i><b>7.3</b> Creating categories with <code>if_else()</code></a></li>
<li class="chapter" data-level="7.4" data-path="035-mutate.html"><a href="035-mutate.html#useful-functions"><i class="fa fa-check"></i><b>7.4</b> Useful functions</a></li>
<li class="chapter" data-level="7.5" data-path="035-mutate.html"><a href="035-mutate.html#bonus-fun-with-date-and-time"><i class="fa fa-check"></i><b>7.5</b> Bonus: Fun with date and time</a></li>
<li class="chapter" data-level="7.6" data-path="035-mutate.html"><a href="035-mutate.html#more-resources"><i class="fa fa-check"></i><b>7.6</b> More resources</a>
<ul>
<li class="chapter" data-level="" data-path="035-mutate.html"><a href="035-mutate.html#tk-exercises"><i class="fa fa-check"></i>TK: Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="036-joins.html"><a href="036-joins.html"><i class="fa fa-check"></i><b>8</b> Verbs Part 4: Combining data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="036-joins.html"><a href="036-joins.html#key-takeaways-7"><i class="fa fa-check"></i><b>8.1</b> Key takeaways</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="036-joins.html"><a href="036-joins.html#adding-rows-instead-of-columns"><i class="fa fa-check"></i><b>8.1.1</b> Adding rows instead of columns</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="036-joins.html"><a href="036-joins.html#concepts-of-joining"><i class="fa fa-check"></i><b>8.2</b> Concepts of joining</a></li>
<li class="chapter" data-level="8.3" data-path="036-joins.html"><a href="036-joins.html#arizona-immunization-data"><i class="fa fa-check"></i><b>8.3</b> Arizona immunization data</a>
<ul>
<li class="chapter" data-level="" data-path="036-joins.html"><a href="036-joins.html#setting-up-the-data"><i class="fa fa-check"></i>Setting up the data</a></li>
<li class="chapter" data-level="" data-path="036-joins.html"><a href="036-joins.html#apply-the-join"><i class="fa fa-check"></i>Apply the join</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="036-joins.html"><a href="036-joins.html#resources-1"><i class="fa fa-check"></i><b>8.4</b> Resources</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="036-joins.html"><a href="036-joins.html#practice"><i class="fa fa-check"></i><b>8.4.1</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Graphics, data cleaning, scraping and more</b></span></li>
<li class="chapter" data-level="9" data-path="041-plotly.html"><a href="041-plotly.html"><i class="fa fa-check"></i><b>9</b> Intro to visualization in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="041-plotly.html"><a href="041-plotly.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>9.1</b> The Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="041-plotly.html"><a href="041-plotly.html#good-resources"><i class="fa fa-check"></i><b>9.1.1</b> Good resources</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="041-plotly.html"><a href="041-plotly.html#building-you-graph-in-pieces-using-gapminder"><i class="fa fa-check"></i><b>9.2</b> Building you graph in pieces using gapminder</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="041-plotly.html"><a href="041-plotly.html#subset-to-just-the-latest-years"><i class="fa fa-check"></i><b>9.2.1</b> Subset to just the latest years</a></li>
<li class="chapter" data-level="9.2.2" data-path="041-plotly.html"><a href="041-plotly.html#the-histogram"><i class="fa fa-check"></i><b>9.2.2</b> The histogram</a></li>
<li class="chapter" data-level="9.2.3" data-path="041-plotly.html"><a href="041-plotly.html#try-a-scatter-or-dot-plot"><i class="fa fa-check"></i><b>9.2.3</b> Try a scatter, or dot plot</a></li>
<li class="chapter" data-level="9.2.4" data-path="041-plotly.html"><a href="041-plotly.html#adding-interactivity"><i class="fa fa-check"></i><b>9.2.4</b> Adding interactivity</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="041-plotly.html"><a href="041-plotly.html#adding-animation"><i class="fa fa-check"></i><b>9.3</b> Adding animation</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A02-programming.html"><a href="A02-programming.html"><i class="fa fa-check"></i><b>A</b> A gentle intro to programming</a>
<ul>
<li class="chapter" data-level="A.1" data-path="A02-programming.html"><a href="A02-programming.html#key-takeaways-8"><i class="fa fa-check"></i><b>A.1</b> Key takeaways</a></li>
<li class="chapter" data-level="A.2" data-path="A02-programming.html"><a href="A02-programming.html#building-blocks"><i class="fa fa-check"></i><b>A.2</b> Building blocks</a>
<ul>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#variables-and-objects"><i class="fa fa-check"></i>Variables and objects</a></li>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#operators-assignment"><i class="fa fa-check"></i>Operators &amp; assignment</a></li>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#loops"><i class="fa fa-check"></i>Loops</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="A02-programming.html"><a href="A02-programming.html#make-an-omelet-with-a-function"><i class="fa fa-check"></i><b>A.3</b> Make an omelet with a function</a>
<ul>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#open-a-restaurant-with-loops"><i class="fa fa-check"></i>Open a restaurant with loops</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="A02-programming.html"><a href="A02-programming.html#applications"><i class="fa fa-check"></i><b>A.4</b> Applications</a></li>
<li class="chapter" data-level="A.5" data-path="A02-programming.html"><a href="A02-programming.html#more-resources-1"><i class="fa fa-check"></i><b>A.5</b> More resources</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="A01-resources.html"><a href="A01-resources.html"><i class="fa fa-check"></i><b>B</b> Great R Resources</a>
<ul>
<li class="chapter" data-level="B.1" data-path="A01-resources.html"><a href="A01-resources.html#key-takeaways-9"><i class="fa fa-check"></i><b>B.1</b> Key takeaways</a></li>
<li class="chapter" data-level="B.2" data-path="A01-resources.html"><a href="A01-resources.html#coursework-in-r"><i class="fa fa-check"></i><b>B.2</b> Coursework in R</a></li>
<li class="chapter" data-level="B.3" data-path="A01-resources.html"><a href="A01-resources.html#instructional-screencasts-and-videos"><i class="fa fa-check"></i><b>B.3</b> Instructional screencasts and videos</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="A04-murders.html"><a href="A04-murders.html"><i class="fa fa-check"></i><b>C</b> Murder Accountability Project exercises</a>
<ul>
<li class="chapter" data-level="C.1" data-path="A04-murders.html"><a href="A04-murders.html#the-data"><i class="fa fa-check"></i><b>C.1</b> The data</a></li>
<li class="chapter" data-level="C.2" data-path="A04-murders.html"><a href="A04-murders.html#exercises-by-chapter"><i class="fa fa-check"></i><b>C.2</b> Exercises by chapter</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="A04-murders.html"><a href="A04-murders.html#select-and-filter-exercises"><i class="fa fa-check"></i><b>C.2.1</b> Select and filter exercises</a></li>
<li class="chapter" data-level="C.2.2" data-path="A04-murders.html"><a href="A04-murders.html#group-by-and-summarise"><i class="fa fa-check"></i><b>C.2.2</b> Group by and summarise</a></li>
<li class="chapter" data-level="C.2.3" data-path="A04-murders.html"><a href="A04-murders.html#mutate"><i class="fa fa-check"></i><b>C.2.3</b> Mutate</a></li>
<li class="chapter" data-level="C.2.4" data-path="A04-murders.html"><a href="A04-murders.html#join"><i class="fa fa-check"></i><b>C.2.4</b> Join</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="A04-murders.html"><a href="A04-murders.html#wrap-up-exercise"><i class="fa fa-check"></i><b>C.3</b> Wrap-up exercise</a></li>
<li class="chapter" data-level="C.4" data-path="A04-murders.html"><a href="A04-murders.html#answers-to-exercises"><i class="fa fa-check"></i><b>C.4</b> Answers to exercises</a>
<ul>
<li class="chapter" data-level="C.4.1" data-path="A04-murders.html"><a href="A04-murders.html#select-and-filter"><i class="fa fa-check"></i><b>C.4.1</b> Select and filter</a></li>
<li class="chapter" data-level="C.4.2" data-path="A04-murders.html"><a href="A04-murders.html#group-by"><i class="fa fa-check"></i><b>C.4.2</b> Group by</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Study Guide for Cronkite School of Journalism</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="verbs-part-3-mutate" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Verbs Part 3: mutate</h1>
<div id="key-takeaways-6" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Key takeaways</h2>
<ul>
<li><code>mutate</code> just means “compute”, or convert one or more variables into something new.</li>
<li>mutate is the equivalent of creating a new column in Excel using a formula</li>
<li>Some of the most important jobs of a <code>mutate</code> statement are:
<ul>
<li>Convert unstandardized data into standardized, such as yes-or-no variables or all lower case</li>
<li>Use arithmetic on numeric variables</li>
<li>Use conditional statements to put different values on variables, instead of filtering one at a time.</li>
<li>Change the data <em>type</em> from, say, text to date and time.</li>
<li>Use functions to combine or pull apart and edit your data.</li>
</ul></li>
</ul>
<div id="read-in-some-data" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Read in some data</h3>
<p>Start with the <a href="https://github.com/cronkitedata/rstudyguide/blob/master/data/az-immunizations-grade6.Rda?raw=true">Arizona immunization data</a> that some other chapters have worked with, loading it and the tidyverse to follow along.</p>
<p>Here are the packages and data used for this chapter. You might need to install some of them.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="035-mutate.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb61-2"><a href="035-mutate.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)       <span class="co"># used for slightly better looking tables</span></span>
<span id="cb61-3"><a href="035-mutate.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)          <span class="co"># even more options with tables</span></span>
<span id="cb61-4"><a href="035-mutate.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)   <span class="co"># used for working with dates</span></span>
<span id="cb61-5"><a href="035-mutate.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)     <span class="co"># used to clean up dirty data and change column names.</span></span>
<span id="cb61-6"><a href="035-mutate.html#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="035-mutate.html#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/az-immunizations-grade6.Rda&quot;</span>)  <span class="co"># you may need to change the path to wherever you saved the data</span></span></code></pre></div>
</div>
</div>
<div id="simple-arithmetic" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Simple arithmetic</h2>
<p>Use the usual arithmetic operators to calculate numbers and create a new column:</p>
<pre><code>  + Addition
  - Subtraction
  * Multiplication
  / Division
  </code></pre>
<p>This example creates a new data frame called <code>immune_pct</code> from a few columns of the original:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="035-mutate.html#cb63-1" aria-hidden="true" tabindex="-1"></a>immune_pct <span class="ot">&lt;-</span> </span>
<span id="cb63-2"><a href="035-mutate.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  grade6_counts <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="035-mutate.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> ( school_name, city, school_type, enrolled, num_immune_mmr) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="035-mutate.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">pct_immune =</span> ( num_immune_mmr<span class="sc">/</span>enrolled) <span class="sc">*</span> <span class="dv">100</span>) </span></code></pre></div>
<p>Here’s what it looks like:</p>
<table>
<thead>
<tr class="header">
<th align="left">school_name</th>
<th align="left">city</th>
<th align="left">school_type</th>
<th align="right">enrolled</th>
<th align="right">num_immune_mmr</th>
<th align="right">pct_immune</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ABRAHAM LINCOLN TRADITIONAL SCHOOL</td>
<td align="left">PHOENIX</td>
<td align="left">PUBLIC</td>
<td align="right">59</td>
<td align="right">58</td>
<td align="right">98.3</td>
</tr>
<tr class="even">
<td align="left">ACACIA ELEMENTARY SCHOOL</td>
<td align="left">PHOENIX</td>
<td align="left">PUBLIC</td>
<td align="right">134</td>
<td align="right">134</td>
<td align="right">100.0</td>
</tr>
<tr class="odd">
<td align="left">ACADEMY DEL SOL - HOPE</td>
<td align="left">TUCSON</td>
<td align="left">CHARTER</td>
<td align="right">53</td>
<td align="right">52</td>
<td align="right">98.1</td>
</tr>
<tr class="even">
<td align="left">ACADEMY OF MATH AND SCIENCE</td>
<td align="left">TUCSON</td>
<td align="left">CHARTER</td>
<td align="right">42</td>
<td align="right">40</td>
<td align="right">95.2</td>
</tr>
<tr class="odd">
<td align="left">ACADEMY OF MATH AND SCIENCE CAMELBACK</td>
<td align="left">PHOENIX</td>
<td align="left">CHARTER</td>
<td align="right">113</td>
<td align="right">113</td>
<td align="right">100.0</td>
</tr>
</tbody>
</table>
</div>
<div id="creating-categories-with-if_else" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Creating categories with <code>if_else()</code></h2>
<p>Sometimes, you want to create categories out of more detailed information. In this case, a threshold of 90 percent immunization is considered the limit under which there is a threat of a measles outbreak, also known as “herd immunity”. To categorize each schools as above or under that level, we need to create a new variable that is based on the value of the percentage we just calcluated. That’s done using an <code>if_else</code> statement, which is in the form:</p>
<pre><code>  if_else (  condition, 
             new value if it&#39;s true, 
             new value if it&#39;s not true)</code></pre>
<p>For example:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="035-mutate.html#cb65-1" aria-hidden="true" tabindex="-1"></a>immune_pct <span class="ot">&lt;-</span> </span>
<span id="cb65-2"><a href="035-mutate.html#cb65-2" aria-hidden="true" tabindex="-1"></a>    immune_pct <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="035-mutate.html#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span> (  <span class="at">threshold_met =</span>  <span class="fu">if_else</span>   ( pct_immune <span class="sc">&gt;=</span> <span class="dv">90</span>, </span>
<span id="cb65-4"><a href="035-mutate.html#cb65-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;Meets threshold&quot;</span>, </span>
<span id="cb65-5"><a href="035-mutate.html#cb65-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;Below threshold&quot;</span>)</span>
<span id="cb65-6"><a href="035-mutate.html#cb65-6" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div>
<p>Now we can do some grouping by the new categories:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="035-mutate.html#cb66-1" aria-hidden="true" tabindex="-1"></a>immune_pct <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="035-mutate.html#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span> (school_type, threshold_met) <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="035-mutate.html#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span> ( <span class="at">school_ct =</span> <span class="fu">n</span>(), </span>
<span id="cb66-4"><a href="035-mutate.html#cb66-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">enrolled =</span> <span class="fu">sum</span>(enrolled)) </span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;school_type&#39;. You can override using the `.groups` argument.</code></pre>
<p>You can practice rolling up by looking at the percent by type.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="035-mutate.html#cb68-1" aria-hidden="true" tabindex="-1"></a>immune_pct <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="035-mutate.html#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span> (school_type, threshold_met) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="035-mutate.html#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span> ( <span class="at">schools =</span> <span class="fu">n</span>(), </span>
<span id="cb68-4"><a href="035-mutate.html#cb68-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">students =</span> <span class="fu">sum</span>(enrolled)) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="035-mutate.html#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span> (   <span class="at">pct_school_type =</span> schools <span class="sc">/</span> <span class="fu">sum</span>(schools, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb68-6"><a href="035-mutate.html#cb68-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">pct_enrolled =</span> students <span class="sc">/</span> <span class="fu">sum</span>(students, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb68-7"><a href="035-mutate.html#cb68-7" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">%&gt;%</span></span>
<span id="cb68-8"><a href="035-mutate.html#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span> ( threshold_met <span class="sc">==</span> <span class="st">&quot;Below threshold&quot;</span>)  </span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;school_type&#39;. You can override using the `.groups` argument.</code></pre>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">school_type</th>
<th align="left">threshold_met</th>
<th align="right">schools</th>
<th align="right">students</th>
<th align="right">pct_school_type</th>
<th align="right">pct_enrolled</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CHARTER</td>
<td align="left">Below threshold</td>
<td align="right">40</td>
<td align="right">2344</td>
<td align="right">20.725389</td>
<td align="right">17.757576</td>
</tr>
<tr class="even">
<td align="left">PRIVATE</td>
<td align="left">Below threshold</td>
<td align="right">10</td>
<td align="right">324</td>
<td align="right">14.925373</td>
<td align="right">12.053571</td>
</tr>
<tr class="odd">
<td align="left">PUBLIC</td>
<td align="left">Below threshold</td>
<td align="right">18</td>
<td align="right">1223</td>
<td align="right">2.777778</td>
<td align="right">1.794544</td>
</tr>
</tbody>
</table>
</div>
<p>You can read this table to say, “More than one-sixth of 6th-grade charter school students could be at risk of contracting measles because their schools have immunization rates below levels experts say are needed to prevent outbreaks.” (The wording is tough here to avoid saying “schools” over and over! )</p>
<p>This strategy can also be used to set unreal values to the special <code>NA</code> as in the MAP murder data that uses the value 999 instead of “unknown” for an age. This is common in survey data.</p>
</div>
<div id="useful-functions" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Useful functions</h2>
<p>Here are some functions you may find yourself using pretty regularly. I’m not going to go into the details, but think about looking some up if you think you need them. In each case, these are just the <code>verbs</code>. You’d put your noun – an existing variable from your data frame – within the parentheses.</p>
<ul>
<li><code>tolower( )</code> , <code>toupper ( )</code>, <code>toproper ( )</code>: Convert to all lower, all upper, or proper case.</li>
<li><code>paste ( )</code>, <code>paste0 ( )</code> : Combine (eg, concatenate) two character variables into one, with a delimiter like a space, or smushed together (paste0)</li>
<li><code>na_if( )</code>, <code>replace_na ()</code> : The first creates NA values if something is true; the other replaces NA values with something else, such as a zero.</li>
<li><code>recode ()</code> : Lets you set up a system to replace codes with words.</li>
<li>Conversion functions: as.character(), as.integer(), as.numeric() and as.double()</li>
</ul>
</div>
<div id="bonus-fun-with-date-and-time" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Bonus: Fun with date and time</h2>
<p>Sometimes your data came to you as text, but you need to treat it as numbers. In journalism, we’re often trying to work with dates that came to us in some non-standard form. This is called changing the <code>data type</code>. <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p>This example comes from the opioid emergency call data shown in earlier chapters.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="035-mutate.html#cb70-1" aria-hidden="true" tabindex="-1"></a>my_link <span class="ot">&lt;-</span> <span class="st">&quot;https://cronkitedata.github.io/cronkite-docs/assets/data/csv/opioidemscalls.csv&quot;</span></span>
<span id="cb70-2"><a href="035-mutate.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#use it in a read_csv command</span></span>
<span id="cb70-3"><a href="035-mutate.html#cb70-3" aria-hidden="true" tabindex="-1"></a>opioid_calls_orig <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_link)</span>
<span id="cb70-4"><a href="035-mutate.html#cb70-4" aria-hidden="true" tabindex="-1"></a>opioid_calls <span class="ot">&lt;-</span> opioid_calls_orig <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="035-mutate.html#cb70-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="035-mutate.html#cb70-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span> (objectid, <span class="at">incident_date_char =</span> incident_date, <span class="at">narcan=</span> narcan_naloxone_given, is_asu_student, <span class="at">is_homeless=</span>is_homeles)</span>
<span id="cb70-7"><a href="035-mutate.html#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="035-mutate.html#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>( opioid_calls)</span></code></pre></div>
<pre><code>## Rows: 650
## Columns: 5
## $ objectid           &lt;dbl&gt; 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…
## $ incident_date_char &lt;chr&gt; &quot;1/3/2017 11:42&quot;, &quot;1/9/2017 1:08&quot;, &quot;1/9/2017 1:55&quot;,…
## $ narcan             &lt;chr&gt; &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;…
## $ is_asu_student     &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No…
## $ is_homeless        &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;…</code></pre>
<p>The date and time in this dataset is a character field, but we want to convert it to a date field and a separate time field. At first, we might just want to get the date value out of the character string. It’s in the form month/day/year hour:minute, so we can use the <code>lubridate::mdy_hm function</code> [When you see a function preceded by two colons as this one does, the author is showing you which package it comes from. In this case, the <code>lubridate</code> package, which you must install before you can use it, has a function <code>mdy_hm</code>.]. This function tries to guess how the character string is formatted:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="035-mutate.html#cb72-1" aria-hidden="true" tabindex="-1"></a>opioid_calls <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="035-mutate.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> ( <span class="at">incident_date =</span> <span class="fu">mdy_hm</span>(incident_date_char)) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="035-mutate.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (incident_date, incident_date_char<span class="sc">:</span>is_homeless) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="035-mutate.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 650
## Columns: 5
## $ incident_date      &lt;dttm&gt; 2017-01-03 11:42:00, 2017-01-09 01:08:00, 2017-01-…
## $ incident_date_char &lt;chr&gt; &quot;1/3/2017 11:42&quot;, &quot;1/9/2017 1:08&quot;, &quot;1/9/2017 1:55&quot;,…
## $ narcan             &lt;chr&gt; &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;…
## $ is_asu_student     &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No…
## $ is_homeless        &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;…</code></pre>
<p>Notice that the new variable is of the type <dttm>, which refers to a date-time combined variable.</p>
<p>Let’s say I want to distinguish weekends from weekdays in this dataset. First, we have to define weekend. Here’s one definition, but you might want to use another: A weekend begins at 3pm on Friday and ends at 6pm on Sunday. (The <code>hour</code> variable is in military time.). Instead of using <code>if_else</code>, this example uses <code>case_when</code>, which lets you choose among a variety of options, not just two.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="035-mutate.html#cb74-1" aria-hidden="true" tabindex="-1"></a>opioid_calls <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="035-mutate.html#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">incident_date =</span> <span class="fu">mdy_hm</span>(incident_date_char), </span>
<span id="cb74-3"><a href="035-mutate.html#cb74-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">day_of_week =</span> <span class="fu">wday</span>(incident_date) ,</span>
<span id="cb74-4"><a href="035-mutate.html#cb74-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">weekday =</span> <span class="fu">weekdays</span>(incident_date),</span>
<span id="cb74-5"><a href="035-mutate.html#cb74-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">hour =</span> <span class="fu">hour</span>(incident_date), </span>
<span id="cb74-6"><a href="035-mutate.html#cb74-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">weekend =</span> </span>
<span id="cb74-7"><a href="035-mutate.html#cb74-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">case_when</span> ( day_of_week <span class="sc">==</span> <span class="dv">7</span>                 <span class="sc">~</span> <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb74-8"><a href="035-mutate.html#cb74-8" aria-hidden="true" tabindex="-1"></a>                          day_of_week <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span> hour <span class="sc">&gt;=</span> <span class="dv">15</span>     <span class="sc">~</span> <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb74-9"><a href="035-mutate.html#cb74-9" aria-hidden="true" tabindex="-1"></a>                          day_of_week <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> hour <span class="sc">&lt;=</span> <span class="dv">18</span>   <span class="sc">~</span> <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb74-10"><a href="035-mutate.html#cb74-10" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span>                             <span class="sc">~</span> <span class="st">&quot;No&quot;</span></span>
<span id="cb74-11"><a href="035-mutate.html#cb74-11" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb74-12"><a href="035-mutate.html#cb74-12" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span></span>
<span id="cb74-13"><a href="035-mutate.html#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use count() instead of group_by / summarise. Same thing in this context.</span></span>
<span id="cb74-14"><a href="035-mutate.html#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span> (day_of_week, weekend, weekday) <span class="sc">%&gt;%</span></span>
<span id="cb74-15"><a href="035-mutate.html#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span> (<span class="at">values_from =</span> n, <span class="at">names_from =</span> weekend, <span class="at">values_fill=</span> <span class="fu">list</span>(<span class="at">n=</span><span class="dv">0</span>))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">day_of_week</th>
<th align="left">weekday</th>
<th align="right">No</th>
<th align="right">Yes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Sunday</td>
<td align="right">19</td>
<td align="right">80</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Monday</td>
<td align="right">78</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Tuesday</td>
<td align="right">87</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Wednesday</td>
<td align="right">87</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Thursday</td>
<td align="right">102</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">Friday</td>
<td align="right">53</td>
<td align="right">41</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">Saturday</td>
<td align="right">0</td>
<td align="right">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="more-resources" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> More resources</h2>
<p>As always, other professors have done similar exercises:</p>
<ul>
<li>Matt Waite’s <a href="https://mattwaite.github.io/datajournalism/mutating-data.html">chapter on “mutate”</a>, which includes a recipe for combining character variables into phrases</li>
</ul>
<div id="tk-exercises" class="section level3 unnumbered">
<h3>TK: Exercises</h3>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>This example uses the library <code>lubridate</code>, which may not be installed in your computer. If you’re following along, you may need to install it in the console.<a href="035-mutate.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="033-groupby.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="036-joins.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "github"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 2
});
});
</script>

</body>

</html>
