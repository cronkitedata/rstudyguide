<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Verbs Part 4: Combining data | R Study Guide for Cronkite School of Journalism</title>
  <meta name="description" content="A companion book for the Cronkite School’s data journalism class for graduate students. A work in progress." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Verbs Part 4: Combining data | R Study Guide for Cronkite School of Journalism" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://cronkitedata.github.io/rstudyguide" />
  
  <meta property="og:description" content="A companion book for the Cronkite School’s data journalism class for graduate students. A work in progress." />
  <meta name="github-repo" content="cronkitedata/rstudyguide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Verbs Part 4: Combining data | R Study Guide for Cronkite School of Journalism" />
  
  <meta name="twitter:description" content="A companion book for the Cronkite School’s data journalism class for graduate students. A work in progress." />
  

<meta name="author" content="Sarah Cohen, Knight Chair in Journalism" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.io" type="image/x-icon" />
<link rel="prev" href="035-mutate.html"/>
<link rel="next" href="A02-programming.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.9/datatables.js"></script>
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="mystyles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Study Guide for Cronkite Students</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-the-examples-with-packages"><i class="fa fa-check"></i>Using the examples with packages</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to R for Journalists</b></span></li>
<li class="chapter" data-level="1" data-path="011-r-install.html"><a href="011-r-install.html"><i class="fa fa-check"></i><b>1</b> An R and R Studio tour</a><ul>
<li class="chapter" data-level="1.1" data-path="011-r-install.html"><a href="011-r-install.html#key-takeaways"><i class="fa fa-check"></i><b>1.1</b> Key takeaways</a></li>
<li class="chapter" data-level="1.2" data-path="011-r-install.html"><a href="011-r-install.html#why-program"><i class="fa fa-check"></i><b>1.2</b> Why program?</a></li>
<li class="chapter" data-level="1.3" data-path="011-r-install.html"><a href="011-r-install.html#setting-up-r-and-r-studio"><i class="fa fa-check"></i><b>1.3</b> Setting up R and R Studio</a></li>
<li class="chapter" data-level="1.4" data-path="011-r-install.html"><a href="011-r-install.html#an-r-studio-tour"><i class="fa fa-check"></i><b>1.4</b> An R Studio tour</a><ul>
<li class="chapter" data-level="1.4.1" data-path="011-r-install.html"><a href="011-r-install.html#the-console"><i class="fa fa-check"></i><b>1.4.1</b> The Console</a></li>
<li class="chapter" data-level="1.4.2" data-path="011-r-install.html"><a href="011-r-install.html#work-in-projects"><i class="fa fa-check"></i><b>1.4.2</b> Work in projects</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="011-r-install.html"><a href="011-r-install.html#unlocking-packages"><i class="fa fa-check"></i><b>1.5</b> Unlocking packages</a></li>
<li class="chapter" data-level="1.6" data-path="011-r-install.html"><a href="011-r-install.html#variables"><i class="fa fa-check"></i><b>1.6</b> Variables</a></li>
<li class="chapter" data-level="1.7" data-path="011-r-install.html"><a href="011-r-install.html#resources-and-exercises"><i class="fa fa-check"></i><b>1.7</b> Resources and exercises</a><ul>
<li class="chapter" data-level="1.7.1" data-path="011-r-install.html"><a href="011-r-install.html#googling-for-help"><i class="fa fa-check"></i><b>1.7.1</b> Googling for help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="021-r-markdown.html"><a href="021-r-markdown.html"><i class="fa fa-check"></i><b>2</b> R Markdown</a><ul>
<li class="chapter" data-level="2.1" data-path="021-r-markdown.html"><a href="021-r-markdown.html#key-takeaways-1"><i class="fa fa-check"></i><b>2.1</b> Key takeaways</a></li>
<li class="chapter" data-level="2.2" data-path="021-r-markdown.html"><a href="021-r-markdown.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>2.2</b> Getting started with R Markdown</a></li>
<li class="chapter" data-level="2.3" data-path="021-r-markdown.html"><a href="021-r-markdown.html#the-anatomy-of-a-document"><i class="fa fa-check"></i><b>2.3</b> The anatomy of a document</a></li>
<li class="chapter" data-level="2.4" data-path="021-r-markdown.html"><a href="021-r-markdown.html#knitting-your-document"><i class="fa fa-check"></i><b>2.4</b> Knitting your document</a></li>
<li class="chapter" data-level="2.5" data-path="021-r-markdown.html"><a href="021-r-markdown.html#code-chunks"><i class="fa fa-check"></i><b>2.5</b> Code chunks</a></li>
<li class="chapter" data-level="2.6" data-path="021-r-markdown.html"><a href="021-r-markdown.html#resources-and-exercises-1"><i class="fa fa-check"></i><b>2.6</b> Resources and exercises</a><ul>
<li class="chapter" data-level="" data-path="021-r-markdown.html"><a href="021-r-markdown.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="021-r-markdown.html"><a href="021-r-markdown.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="021-r-markdown.html"><a href="021-r-markdown.html#bonus-styling-your-r-markdown-documents"><i class="fa fa-check"></i><b>2.7</b> Bonus: Styling your R Markdown documents</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="022-data-frames.html"><a href="022-data-frames.html"><i class="fa fa-check"></i><b>3</b> Data frames and the tidyverse</a><ul>
<li class="chapter" data-level="3.1" data-path="022-data-frames.html"><a href="022-data-frames.html#key-takeaways-2"><i class="fa fa-check"></i><b>3.1</b> Key takeaways</a></li>
<li class="chapter" data-level="3.2" data-path="022-data-frames.html"><a href="022-data-frames.html#getting-started"><i class="fa fa-check"></i><b>3.2</b> Getting started</a></li>
<li class="chapter" data-level="3.3" data-path="022-data-frames.html"><a href="022-data-frames.html#the-data-frame"><i class="fa fa-check"></i><b>3.3</b> The data frame</a><ul>
<li class="chapter" data-level="3.3.1" data-path="022-data-frames.html"><a href="022-data-frames.html#loading-and-looking-at-data"><i class="fa fa-check"></i><b>3.3.1</b> Loading and looking at data</a></li>
<li class="chapter" data-level="3.3.2" data-path="022-data-frames.html"><a href="022-data-frames.html#examine-your-data"><i class="fa fa-check"></i><b>3.3.2</b> Examine your data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="022-data-frames.html"><a href="022-data-frames.html#introducing-the-pipe"><i class="fa fa-check"></i><b>3.4</b> Introducing the pipe</a></li>
<li class="chapter" data-level="3.5" data-path="022-data-frames.html"><a href="022-data-frames.html#take-a-break"><i class="fa fa-check"></i><b>3.5</b> Take a break</a></li>
<li class="chapter" data-level="3.6" data-path="022-data-frames.html"><a href="022-data-frames.html#other-resources-1"><i class="fa fa-check"></i><b>3.6</b> Other resources</a><ul>
<li class="chapter" data-level="3.6.1" data-path="022-data-frames.html"><a href="022-data-frames.html#on-your-own"><i class="fa fa-check"></i><b>3.6.1</b> On your own</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II The Verbs of the Tidyverse</b></span></li>
<li class="chapter" data-level="4" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html"><i class="fa fa-check"></i><b>4</b> A quick tour of verbs</a><ul>
<li class="chapter" data-level="4.1" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#key-takeaways-3"><i class="fa fa-check"></i><b>4.1</b> Key takeaways</a><ul>
<li class="chapter" data-level="" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#data-for-this-walkthrough"><i class="fa fa-check"></i>Data for this walkthrough</a></li>
<li class="chapter" data-level="4.1.1" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#follow-along"><i class="fa fa-check"></i><b>4.1.1</b> Follow along</a></li>
<li><a href="030-intro-verbs.html#the-operator-and-then">The <code>%&gt;%</code> operator: … and then…</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#looking-at-your-data-in-pieces-and-in-order"><i class="fa fa-check"></i><b>4.2</b> Looking at your data in pieces and in order</a><ul>
<li class="chapter" data-level="4.2.1" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#select-to-pick-out-columns"><i class="fa fa-check"></i><b>4.2.1</b> <code>select</code> to pick out columns</a></li>
<li class="chapter" data-level="4.2.2" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#arrange-to-sort"><i class="fa fa-check"></i><b>4.2.2</b> <code>arrange</code> to sort</a></li>
<li class="chapter" data-level="4.2.3" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#filter-to-pick-out-rows"><i class="fa fa-check"></i><b>4.2.3</b> <code>filter</code> to pick out rows</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#group_by-and-summarise-to-count-and-sum"><i class="fa fa-check"></i><b>4.3</b> <code>group_by</code> and <code>summarise</code> to count and sum</a></li>
<li class="chapter" data-level="4.4" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#mutate-to-calculate-something-new"><i class="fa fa-check"></i><b>4.4</b> <code>mutate</code> to calculate something new</a></li>
<li class="chapter" data-level="4.5" data-path="030-intro-verbs.html"><a href="030-intro-verbs.html#join-to-merge-tables-together-by-column-union-to-add-rows"><i class="fa fa-check"></i><b>4.5</b> <code>join</code> to merge tables together by column; <code>union</code> to add rows</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="031-select-filter.html"><a href="031-select-filter.html"><i class="fa fa-check"></i><b>5</b> Verbs Part 1: Picking and choosing</a><ul>
<li class="chapter" data-level="5.1" data-path="031-select-filter.html"><a href="031-select-filter.html#key-takeaways-4"><i class="fa fa-check"></i><b>5.1</b> Key takeaways</a></li>
<li class="chapter" data-level="5.2" data-path="031-select-filter.html"><a href="031-select-filter.html#select---choosing-columns"><i class="fa fa-check"></i><b>5.2</b> Select - choosing columns</a><ul>
<li class="chapter" data-level="" data-path="031-select-filter.html"><a href="031-select-filter.html#optional-other-ways-to-select"><i class="fa fa-check"></i>Optional: Other ways to select</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="031-select-filter.html"><a href="031-select-filter.html#filter---choosing-rows"><i class="fa fa-check"></i><b>5.3</b> Filter - choosing rows</a><ul>
<li class="chapter" data-level="5.3.1" data-path="031-select-filter.html"><a href="031-select-filter.html#one-filter"><i class="fa fa-check"></i><b>5.3.1</b> One filter</a></li>
<li class="chapter" data-level="5.3.2" data-path="031-select-filter.html"><a href="031-select-filter.html#a-compound-filter"><i class="fa fa-check"></i><b>5.3.2</b> A compound filter</a></li>
<li class="chapter" data-level="5.3.3" data-path="031-select-filter.html"><a href="031-select-filter.html#even-more-compound-filters"><i class="fa fa-check"></i><b>5.3.3</b> Even more compound filters</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="031-select-filter.html"><a href="031-select-filter.html#arrange---change-the-order"><i class="fa fa-check"></i><b>5.4</b> Arrange - change the order</a></li>
<li class="chapter" data-level="5.5" data-path="031-select-filter.html"><a href="031-select-filter.html#traps"><i class="fa fa-check"></i><b>5.5</b> Traps</a></li>
<li class="chapter" data-level="5.6" data-path="031-select-filter.html"><a href="031-select-filter.html#resources-1"><i class="fa fa-check"></i><b>5.6</b> Resources</a><ul>
<li class="chapter" data-level="5.6.1" data-path="031-select-filter.html"><a href="031-select-filter.html#exercises-1"><i class="fa fa-check"></i><b>5.6.1</b> Exercises</a></li>
<li class="chapter" data-level="5.6.2" data-path="031-select-filter.html"><a href="031-select-filter.html#tutorials"><i class="fa fa-check"></i><b>5.6.2</b> Tutorials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="033-groupby.html"><a href="033-groupby.html"><i class="fa fa-check"></i><b>6</b> Verbs Part 2: group_by and summarise</a><ul>
<li class="chapter" data-level="6.1" data-path="033-groupby.html"><a href="033-groupby.html#key-takeaways-5"><i class="fa fa-check"></i><b>6.1</b> Key takeaways</a></li>
<li class="chapter" data-level="6.2" data-path="033-groupby.html"><a href="033-groupby.html#group_by-summarise-basics"><i class="fa fa-check"></i><b>6.2</b> group_by / summarise basics</a><ul>
<li class="chapter" data-level="6.2.1" data-path="033-groupby.html"><a href="033-groupby.html#other-summary-functions"><i class="fa fa-check"></i><b>6.2.1</b> Other summary functions</a></li>
<li class="chapter" data-level="6.2.2" data-path="033-groupby.html"><a href="033-groupby.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>6.2.2</b> Grouping by more than one variable</a></li>
<li class="chapter" data-level="6.2.3" data-path="033-groupby.html"><a href="033-groupby.html#rolling-up-to-the-next-level"><i class="fa fa-check"></i><b>6.2.3</b> Rolling up to the next level</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="033-groupby.html"><a href="033-groupby.html#restructuring-for-a-report-with-pivot_wider"><i class="fa fa-check"></i><b>6.3</b> Restructuring for a report with <code>pivot_wider()</code></a><ul>
<li class="chapter" data-level="6.3.1" data-path="033-groupby.html"><a href="033-groupby.html#a-note-on-restructuring-your-data-frames"><i class="fa fa-check"></i><b>6.3.1</b> A note on restructuring your data frames</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="033-groupby.html"><a href="033-groupby.html#resources-exercises"><i class="fa fa-check"></i><b>6.4</b> Resources &amp; exercises</a><ul>
<li class="chapter" data-level="6.4.1" data-path="033-groupby.html"><a href="033-groupby.html#exercises-2"><i class="fa fa-check"></i><b>6.4.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="035-mutate.html"><a href="035-mutate.html"><i class="fa fa-check"></i><b>7</b> Verbs Part 3: mutate</a><ul>
<li class="chapter" data-level="7.1" data-path="035-mutate.html"><a href="035-mutate.html#key-takeaways-6"><i class="fa fa-check"></i><b>7.1</b> Key takeaways</a><ul>
<li class="chapter" data-level="7.1.1" data-path="035-mutate.html"><a href="035-mutate.html#read-in-some-data"><i class="fa fa-check"></i><b>7.1.1</b> Read in some data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="035-mutate.html"><a href="035-mutate.html#simple-arithmetic"><i class="fa fa-check"></i><b>7.2</b> Simple arithmetic</a></li>
<li class="chapter" data-level="7.3" data-path="035-mutate.html"><a href="035-mutate.html#creating-categories-with-if_else"><i class="fa fa-check"></i><b>7.3</b> Creating categories with <code>if_else()</code></a></li>
<li class="chapter" data-level="7.4" data-path="035-mutate.html"><a href="035-mutate.html#useful-functions"><i class="fa fa-check"></i><b>7.4</b> Useful functions</a></li>
<li class="chapter" data-level="7.5" data-path="035-mutate.html"><a href="035-mutate.html#bonus-fun-with-date-and-time"><i class="fa fa-check"></i><b>7.5</b> Bonus: Fun with date and time</a></li>
<li class="chapter" data-level="7.6" data-path="035-mutate.html"><a href="035-mutate.html#more-resources"><i class="fa fa-check"></i><b>7.6</b> More resources</a><ul>
<li class="chapter" data-level="" data-path="035-mutate.html"><a href="035-mutate.html#tk-exercises"><i class="fa fa-check"></i>TK: Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="036-joins.html"><a href="036-joins.html"><i class="fa fa-check"></i><b>8</b> Verbs Part 4: Combining data</a><ul>
<li class="chapter" data-level="8.1" data-path="036-joins.html"><a href="036-joins.html#key-takeaways-7"><i class="fa fa-check"></i><b>8.1</b> Key takeaways</a><ul>
<li class="chapter" data-level="8.1.1" data-path="036-joins.html"><a href="036-joins.html#adding-rows-instead-of-columns"><i class="fa fa-check"></i><b>8.1.1</b> Adding rows instead of columns</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="036-joins.html"><a href="036-joins.html#concepts-of-joining"><i class="fa fa-check"></i><b>8.2</b> Concepts of joining</a></li>
<li class="chapter" data-level="8.3" data-path="036-joins.html"><a href="036-joins.html#arizona-immunization-data"><i class="fa fa-check"></i><b>8.3</b> Arizona immunization data</a><ul>
<li class="chapter" data-level="" data-path="036-joins.html"><a href="036-joins.html#setting-up-the-data"><i class="fa fa-check"></i>Setting up the data</a></li>
<li class="chapter" data-level="" data-path="036-joins.html"><a href="036-joins.html#apply-the-join"><i class="fa fa-check"></i>Apply the join</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="036-joins.html"><a href="036-joins.html#resources-2"><i class="fa fa-check"></i><b>8.4</b> Resources</a><ul>
<li class="chapter" data-level="8.4.1" data-path="036-joins.html"><a href="036-joins.html#practice"><i class="fa fa-check"></i><b>8.4.1</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A02-programming.html"><a href="A02-programming.html"><i class="fa fa-check"></i><b>A</b> A gentle intro to programming</a><ul>
<li class="chapter" data-level="A.1" data-path="A02-programming.html"><a href="A02-programming.html#key-takeaways-8"><i class="fa fa-check"></i><b>A.1</b> Key takeaways</a></li>
<li class="chapter" data-level="A.2" data-path="A02-programming.html"><a href="A02-programming.html#building-blocks"><i class="fa fa-check"></i><b>A.2</b> Building blocks</a><ul>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#variables-and-objects"><i class="fa fa-check"></i>Variables and objects</a></li>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#operators-assignment"><i class="fa fa-check"></i>Operators &amp; assignment</a></li>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#loops"><i class="fa fa-check"></i>Loops</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="A02-programming.html"><a href="A02-programming.html#make-an-omelet-with-a-function"><i class="fa fa-check"></i><b>A.3</b> Make an omelet with a function</a><ul>
<li class="chapter" data-level="" data-path="A02-programming.html"><a href="A02-programming.html#open-a-restaurant-with-loops"><i class="fa fa-check"></i>Open a restaurant with loops</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="A02-programming.html"><a href="A02-programming.html#applications"><i class="fa fa-check"></i><b>A.4</b> Applications</a></li>
<li class="chapter" data-level="A.5" data-path="A02-programming.html"><a href="A02-programming.html#more-resources-1"><i class="fa fa-check"></i><b>A.5</b> More resources</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="A01-resources.html"><a href="A01-resources.html"><i class="fa fa-check"></i><b>B</b> Great R Resources</a><ul>
<li class="chapter" data-level="B.1" data-path="A01-resources.html"><a href="A01-resources.html#key-takeaways-9"><i class="fa fa-check"></i><b>B.1</b> Key takeaways</a></li>
<li class="chapter" data-level="B.2" data-path="A01-resources.html"><a href="A01-resources.html#coursework-in-r"><i class="fa fa-check"></i><b>B.2</b> Coursework in R</a></li>
<li class="chapter" data-level="B.3" data-path="A01-resources.html"><a href="A01-resources.html#instructional-screencasts-and-videos"><i class="fa fa-check"></i><b>B.3</b> Instructional screencasts and videos</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="A04-murders.html"><a href="A04-murders.html"><i class="fa fa-check"></i><b>C</b> Murder Accountability Project exercises</a><ul>
<li class="chapter" data-level="C.1" data-path="A04-murders.html"><a href="A04-murders.html#the-data"><i class="fa fa-check"></i><b>C.1</b> The data</a></li>
<li class="chapter" data-level="C.2" data-path="A04-murders.html"><a href="A04-murders.html#exercises-by-chapter"><i class="fa fa-check"></i><b>C.2</b> Exercises by chapter</a><ul>
<li class="chapter" data-level="C.2.1" data-path="A04-murders.html"><a href="A04-murders.html#select-and-filter-exercises"><i class="fa fa-check"></i><b>C.2.1</b> Select and filter exercises</a></li>
<li class="chapter" data-level="C.2.2" data-path="A04-murders.html"><a href="A04-murders.html#group-by-and-summarise"><i class="fa fa-check"></i><b>C.2.2</b> Group by and summarise</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="A04-murders.html"><a href="A04-murders.html#answers-to-exercises"><i class="fa fa-check"></i><b>C.3</b> Answers to exercises</a><ul>
<li class="chapter" data-level="C.3.1" data-path="A04-murders.html"><a href="A04-murders.html#select-and-filter"><i class="fa fa-check"></i><b>C.3.1</b> Select and filter</a></li>
<li class="chapter" data-level="C.3.2" data-path="A04-murders.html"><a href="A04-murders.html#group-by"><i class="fa fa-check"></i><b>C.3.2</b> Group by</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Study Guide for Cronkite School of Journalism</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="verbs-part-4-combining-data" class="section level1">
<h1><span class="header-section-number">8</span> Verbs Part 4: Combining data</h1>
<p>You’ll often find yourself attempting to put together two or more data sets. To add combine columns – getting more variables – use one of the <code>join</code> functions. To add rows – stacking datasets – use <code>bind_rows()</code>. This tutorial only addresses combining columns.</p>
<p>Reporters use joins to:</p>
<ul>
<li>Add information from one table, such demogrphics, to another, such as a list of counties.</li>
<li>Use “lookup tables” from more traditional databases, which list codes that match to a dictionary of other values. For example, campaign finance data usually comes with a committee ID in donation datasets. Those ID’s match to details on a candidate or political action committee in another.</li>
<li>Match one set of records against a completely different one to find potential stories. Some of the most famous data journalism investigations used this kind of join to find, for example, school bus drivers who have DUI’s or daycare centers run by people with serious criminal histories.</li>
</ul>
<div id="key-takeaways-7" class="section level2">
<h2><span class="header-section-number">8.1</span> Key takeaways</h2>
<ul>
<li>Combining two tables requires exact matches on one or more variables. Close matches don’t count.</li>
<li>Whenever you can get codes to go with your data, get them – you never know when you’ll run across another dataset with the same code.</li>
<li>You can use information from one table to learn more about another, especially when you have geographic information by county, Census tract or zip code.
For example, you might combine the number of murders in a county with its population to create a murder rate.</li>
<li>Many public records databases come with “lookup tables”. Be sure to request them so you can match a code, such as “G” to its translation, such as “Great!”</li>
</ul>
<div id="adding-rows-instead-of-columns" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Adding rows instead of columns</h3>
<p>Joining only adds columns (or variables) to your data. If you need to stack tables on top of each other, use the <code>bind_rows(data frame 1, data frame 2)</code> function.</p>
</div>
</div>
<div id="concepts-of-joining" class="section level2">
<h2><span class="header-section-number">8.2</span> Concepts of joining</h2>
<p>In R, as in most other language, “joins” work by matching one table against another using a common variable.
For example, the Federal Election Commission holds information about donors in one data frame, and information about candidates and other political action committees in another. They link together using the common identifier of a committee ID.</p>
<div class="figure">
<img src="images/36-contrib-names.png" alt="Campaign finance join" />
<p class="caption">Campaign finance join</p>
</div>
<div class="figure">
<img src="images/36-cand-names.png" alt="Campaign finance join" />
<p class="caption">Campaign finance join</p>
</div>
<p>(They don’t need to have the same name, and they don’t need to be in the first column.)</p>
<p>The key is that the donor data includes the <em>many</em> donations to any given candidate, but the committee table only lists each political group once. Even in this example, although Martha McSally and Kyrsten Sinema are listed twice, there are for two separate political entities. The reason to do this is that you never have to worry that any changes to the candidate information – the treasurer, the address or the office sought – carries over to the donation. It’s only listed once, in the lookup table. Most large databases are constructed this way. For example:</p>
<ul>
<li>Your school records are held using your student ID, which means that your address only needs to be changed once, not in every class or in every account you have with the school.</li>
<li>An inspection record typically has three tables: An establishment (like a restaurant or a workplace), an inspection, and a violation. They’re linked together using establishment ID’s.</li>
<li>A court database usually has many types of records: A case record, a list of charges, sentences and defendants.</li>
</ul>
<p>Think back on the work we did to identify a <code>unit of analysis</code>. All of these databases have different tables, or data frames, for each unit of analysis.</p>
<p>There two kinds of joins you’ll most frequently use are:</p>
<ul>
<li><code>inner_join</code>: Only matching rows are kept. Anything without a match is dropped. These are usually used in databases built with joining in mind.</li>
<li><code>left_join</code> : Keep everything from the first table listed, drop anything that doesn’t match from the second one, which you’ll use when you need to join tables that come from different agencies or systems, and you’re not sure you’ll have a good match.</li>
</ul>
</div>
<div id="arizona-immunization-data" class="section level2">
<h2><span class="header-section-number">8.3</span> Arizona immunization data</h2>
<p>I matched up the information from most of the public and charter schools in Arizona against Department of Education statistics to find their federal ID numbers. There are two tables that have to be matched against one another: The immunization statistics by school, and the National Center for Education Statistics characteristics. They are both saved in the R dataset called <a href="https://github.com/cronkitedata/rstudyguide/blob/master/data/immune_to_nces.Rda?raw=true">immune_to_nces.Rda</a>, which you can add to your environment using the <code>load()</code> command.</p>
<p>There are 2,414 schools in the NCES database, but only 841 schools in the immunizations because we’ve only kept schools that had students in Grade 6. There were seven schools that I couldn’t find in the NCES data, and their IDs are blank.</p>
<p>Here are their variables:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">glimpse</span>(grade6_to_nces)</a></code></pre></div>
<pre><code>## Observations: 841
## Variables: 17
## $ rowid              &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14…
## $ nces_id            &lt;chr&gt; &quot;040906000652&quot;, &quot;040906000915&quot;, &quot;040079703230…
## $ school_name        &lt;chr&gt; &quot;ABRAHAM LINCOLN TRADITIONAL SCHOOL&quot;, &quot;ACACIA…
## $ address            &lt;chr&gt; &quot;10444 N 39TH AVE&quot;, &quot;3021 W EVANS DR&quot;, &quot;7102 …
## $ city               &lt;chr&gt; &quot;PHOENIX&quot;, &quot;PHOENIX&quot;, &quot;TUCSON&quot;, &quot;TUCSON&quot;, &quot;PH…
## $ county             &lt;chr&gt; &quot;MARICOPA&quot;, &quot;MARICOPA&quot;, &quot;PIMA&quot;, &quot;PIMA&quot;, &quot;MARI…
## $ zip_code           &lt;chr&gt; &quot;85051&quot;, &quot;85053&quot;, &quot;85757&quot;, &quot;85705&quot;, &quot;85033&quot;, …
## $ school_nurse       &lt;chr&gt; &quot;NO&quot;, &quot;YES&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;N…
## $ school_type        &lt;chr&gt; &quot;PUBLIC&quot;, &quot;PUBLIC&quot;, &quot;CHARTER&quot;, &quot;CHARTER&quot;, &quot;CH…
## $ enrolled           &lt;dbl&gt; 59, 134, 53, 42, 113, 56, 75, 44, 45, 106, 53…
## $ num_immune_mmr     &lt;dbl&gt; 58, 134, 52, 40, 113, 55, 73, 39, 44, 105, 46…
## $ num_exempt_mmr     &lt;dbl&gt; 1, 0, 1, 2, 0, 1, 2, 0, 1, 1, 7, 3, 0, 0, 0, …
## $ num_compliance_mmr &lt;dbl&gt; 59, 134, 53, 42, 113, 56, 75, 44, 45, 106, 53…
## $ num_pbe            &lt;dbl&gt; 5, 2, 1, 0, 3, 6, 4, 0, 23, 4, 9, 3, 1, 1, 0,…
## $ num_medical_exempt &lt;dbl&gt; 2, 0, 0, 7, 0, 6, 0, 0, 0, 0, 1, 0, 0, 1, 0, …
## $ num_pbe_exempt_all &lt;dbl&gt; 5, 0, 1, 0, 0, 0, 1, 0, 2, 1, 10, 3, 0, 0, 0,…
## $ match_type         &lt;chr&gt; &quot;Yes&quot;, &quot;Manual&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, …</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">glimpse</span> (nces_master)</a></code></pre></div>
<pre><code>## Observations: 2,414
## Variables: 15
## $ rowid              &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14…
## $ nces_school_id     &lt;chr&gt; &quot;040553000451&quot;, &quot;040463000999&quot;, &quot;040010601892…
## $ nces_district_id   &lt;chr&gt; &quot;0405530&quot;, &quot;0404630&quot;, &quot;0400106&quot;, &quot;0400417&quot;, &quot;…
## $ nces_district_name &lt;chr&gt; &quot;Nogales Unified District&quot;, &quot;Marana Unified D…
## $ nces_school_name   &lt;chr&gt; &quot;A J MITCHELL ELEMENTARY SCHOOL&quot;, &quot;A. C. E.&quot;,…
## $ nces_school_type   &lt;chr&gt; &quot;1-Regular school&quot;, &quot;1-Regular school&quot;, &quot;1-Re…
## $ nces_urban         &lt;chr&gt; &quot;33-Town: Remote&quot;, &quot;41-Rural: Fringe&quot;, &quot;11-Ci…
## $ nces_student_ct    &lt;dbl&gt; 406, 10, 313, 444, 517, 608, 868, 643, NA, 61…
## $ nces_fte_teacher   &lt;dbl&gt; 20.50, 6.80, NA, NA, 25.60, 32.75, 45.87, 0.0…
## $ nces_ratio         &lt;dbl&gt; 19.80, 1.47, NA, NA, 20.20, 18.56, 18.92, NA,…
## $ nces_lowest        &lt;chr&gt; &quot;Kindergarten&quot;, &quot;7th Grade&quot;, &quot;9th Grade&quot;, &quot;9t…
## $ nces_highest       &lt;chr&gt; &quot;5th Grade&quot;, &quot;12th Grade&quot;, &quot;12th Grade&quot;, &quot;12t…
## $ nces_school_level  &lt;chr&gt; &quot;Elementary&quot;, &quot;High&quot;, &quot;High&quot;, &quot;High&quot;, &quot;Elemen…
## $ nces_county_name   &lt;chr&gt; &quot;Santa Cruz County&quot;, &quot;Pima County&quot;, &quot;Maricopa…
## $ nces_fips          &lt;chr&gt; &quot;04023&quot;, &quot;04019&quot;, &quot;04013&quot;, &quot;04013&quot;, &quot;04025&quot;, …</code></pre>
<div id="setting-up-the-data" class="section level3 unnumbered">
<h3>Setting up the data</h3>
<p>In this case, we want to get information that the federal government had on the schools attached to the immunization data. In particular, we’d like to be able to generate statistics by district, by urbanization and type of school, and we’d like to keep the code for the county so we can link it up to other datasets.</p>
<p>To make it simple, I’ll just create a small set of data for each table:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">immune &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="st">  </span>grade6_to_nces <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="st">  </span><span class="kw">select</span> (rowid, nces_id, school_name, city, county, zip_code, school_nurse, school_type,</a>
<a class="sourceLine" id="cb71-4" title="4">          enrolled, num_immune_mmr) </a>
<a class="sourceLine" id="cb71-5" title="5"></a>
<a class="sourceLine" id="cb71-6" title="6"></a>
<a class="sourceLine" id="cb71-7" title="7">school_list &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb71-8" title="8"><span class="st">  </span>nces_master <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-9" title="9"><span class="st">  </span><span class="kw">select</span> (nces_school_id, nces_district_id, nces_district_name, nces_school_type, </a>
<a class="sourceLine" id="cb71-10" title="10">          nces_urban, nces_ratio, nces_school_level, nces_fips)</a></code></pre></div>
</div>
<div id="apply-the-join" class="section level3 unnumbered">
<h3>Apply the join</h3>
<p>Here are two ways to join:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">immune <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="st">  </span><span class="kw">inner_join</span> (school_list, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;nces_id&quot;</span> =<span class="st"> &quot;nces_school_id&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-3" title="3"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>## Observations: 834
## Variables: 17
## $ rowid              &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14…
## $ nces_id            &lt;chr&gt; &quot;040906000652&quot;, &quot;040906000915&quot;, &quot;040079703230…
## $ school_name        &lt;chr&gt; &quot;ABRAHAM LINCOLN TRADITIONAL SCHOOL&quot;, &quot;ACACIA…
## $ city               &lt;chr&gt; &quot;PHOENIX&quot;, &quot;PHOENIX&quot;, &quot;TUCSON&quot;, &quot;TUCSON&quot;, &quot;PH…
## $ county             &lt;chr&gt; &quot;MARICOPA&quot;, &quot;MARICOPA&quot;, &quot;PIMA&quot;, &quot;PIMA&quot;, &quot;MARI…
## $ zip_code           &lt;chr&gt; &quot;85051&quot;, &quot;85053&quot;, &quot;85757&quot;, &quot;85705&quot;, &quot;85033&quot;, …
## $ school_nurse       &lt;chr&gt; &quot;NO&quot;, &quot;YES&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;N…
## $ school_type        &lt;chr&gt; &quot;PUBLIC&quot;, &quot;PUBLIC&quot;, &quot;CHARTER&quot;, &quot;CHARTER&quot;, &quot;CH…
## $ enrolled           &lt;dbl&gt; 59, 134, 53, 42, 113, 56, 75, 44, 45, 106, 53…
## $ num_immune_mmr     &lt;dbl&gt; 58, 134, 52, 40, 113, 55, 73, 39, 44, 105, 46…
## $ nces_district_id   &lt;chr&gt; &quot;0409060&quot;, &quot;0409060&quot;, &quot;0400797&quot;, &quot;0400368&quot;, &quot;…
## $ nces_district_name &lt;chr&gt; &quot;Washington Elementary School District&quot;, &quot;Was…
## $ nces_school_type   &lt;chr&gt; &quot;1-Regular school&quot;, &quot;1-Regular school&quot;, &quot;1-Re…
## $ nces_urban         &lt;chr&gt; &quot;11-City: Large&quot;, &quot;11-City: Large&quot;, &quot;21-Subur…
## $ nces_ratio         &lt;dbl&gt; 18.56, 18.92, NA, NA, NA, NA, NA, NA, NA, 19.…
## $ nces_school_level  &lt;chr&gt; &quot;Elementary&quot;, &quot;Elementary&quot;, &quot;Elementary&quot;, &quot;Ot…
## $ nces_fips          &lt;chr&gt; &quot;04013&quot;, &quot;04013&quot;, &quot;04019&quot;, &quot;04019&quot;, &quot;04013&quot;, …</code></pre>
<p>You can see that the information from the federal Education Department was added to the immunization data, but we lost seven records – the seven that I couldn’t find in the federal department.</p>
<p>To preserve these records, you’ll usually protect one of the tables – the one you care about most – and keep everything, even if it doesn’t match. To do that, use a <code>left</code> or <code>right</code> join, depending on whether you mention the table first or second. In this case:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">immune_joined &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="st">  </span>immune <span class="op">%&gt;%</span><span class="st">                                     </span><span class="co"># the table I want to protect</span></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="st">  </span><span class="kw">left_join</span> ( school_list,                       <span class="co"># the table I want to apply to my original data frame</span></a>
<a class="sourceLine" id="cb74-4" title="4">              <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;nces_id&quot;</span>=<span class="st">&quot;nces_school_id&quot;</span>) ) <span class="co"># the variable that is the same in the two tables.</span></a>
<a class="sourceLine" id="cb74-5" title="5"></a>
<a class="sourceLine" id="cb74-6" title="6"><span class="kw">glimpse</span>(immune_joined)</a></code></pre></div>
<pre><code>## Observations: 841
## Variables: 17
## $ rowid              &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14…
## $ nces_id            &lt;chr&gt; &quot;040906000652&quot;, &quot;040906000915&quot;, &quot;040079703230…
## $ school_name        &lt;chr&gt; &quot;ABRAHAM LINCOLN TRADITIONAL SCHOOL&quot;, &quot;ACACIA…
## $ city               &lt;chr&gt; &quot;PHOENIX&quot;, &quot;PHOENIX&quot;, &quot;TUCSON&quot;, &quot;TUCSON&quot;, &quot;PH…
## $ county             &lt;chr&gt; &quot;MARICOPA&quot;, &quot;MARICOPA&quot;, &quot;PIMA&quot;, &quot;PIMA&quot;, &quot;MARI…
## $ zip_code           &lt;chr&gt; &quot;85051&quot;, &quot;85053&quot;, &quot;85757&quot;, &quot;85705&quot;, &quot;85033&quot;, …
## $ school_nurse       &lt;chr&gt; &quot;NO&quot;, &quot;YES&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;N…
## $ school_type        &lt;chr&gt; &quot;PUBLIC&quot;, &quot;PUBLIC&quot;, &quot;CHARTER&quot;, &quot;CHARTER&quot;, &quot;CH…
## $ enrolled           &lt;dbl&gt; 59, 134, 53, 42, 113, 56, 75, 44, 45, 106, 53…
## $ num_immune_mmr     &lt;dbl&gt; 58, 134, 52, 40, 113, 55, 73, 39, 44, 105, 46…
## $ nces_district_id   &lt;chr&gt; &quot;0409060&quot;, &quot;0409060&quot;, &quot;0400797&quot;, &quot;0400368&quot;, &quot;…
## $ nces_district_name &lt;chr&gt; &quot;Washington Elementary School District&quot;, &quot;Was…
## $ nces_school_type   &lt;chr&gt; &quot;1-Regular school&quot;, &quot;1-Regular school&quot;, &quot;1-Re…
## $ nces_urban         &lt;chr&gt; &quot;11-City: Large&quot;, &quot;11-City: Large&quot;, &quot;21-Subur…
## $ nces_ratio         &lt;dbl&gt; 18.56, 18.92, NA, NA, NA, NA, NA, NA, NA, 19.…
## $ nces_school_level  &lt;chr&gt; &quot;Elementary&quot;, &quot;Elementary&quot;, &quot;Elementary&quot;, &quot;Ot…
## $ nces_fips          &lt;chr&gt; &quot;04013&quot;, &quot;04013&quot;, &quot;04019&quot;, &quot;04019&quot;, &quot;04013&quot;, …</code></pre>
<p>Here are the rows that were kept without a match:</p>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">rowid</th>
<th align="left">nces_id</th>
<th align="left">school_name</th>
<th align="left">city</th>
<th align="left">county</th>
<th align="left">zip_code</th>
<th align="left">school_nurse</th>
<th align="left">school_type</th>
<th align="right">enrolled</th>
<th align="right">num_immune_mmr</th>
<th align="left">nces_district_id</th>
<th align="left">nces_district_name</th>
<th align="left">nces_school_type</th>
<th align="left">nces_urban</th>
<th align="right">nces_ratio</th>
<th align="left">nces_school_level</th>
<th align="left">nces_fips</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">43</td>
<td align="left">NA</td>
<td align="left">ARCADIA NEIGHBORHOOD LEARNING CENTER</td>
<td align="left">SCOTTSDALE</td>
<td align="left">MARICOPA</td>
<td align="left">85251</td>
<td align="left">YES</td>
<td align="left">PUBLIC</td>
<td align="right">52</td>
<td align="right">49</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">209</td>
<td align="left">NA</td>
<td align="left">DENNEHOTSO BOARDING SCHOOL</td>
<td align="left">DENNEHOTSO</td>
<td align="left">APACHE</td>
<td align="left">86535</td>
<td align="left">NO</td>
<td align="left">PUBLIC</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">414</td>
<td align="left">NA</td>
<td align="left">J.C.U.S.D. - JOSEPH CITY PRESCHOOL</td>
<td align="left">JOSEPH CITY</td>
<td align="left">NAVAJO</td>
<td align="left">86032</td>
<td align="left">NO</td>
<td align="left">PUBLIC</td>
<td align="right">33</td>
<td align="right">28</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">452</td>
<td align="left">NA</td>
<td align="left">L.H.U.S.D. #1 - DEVELOPMENTAL PRESCHOOL</td>
<td align="left">LAKE HAVASU CITY</td>
<td align="left">MOHAVE</td>
<td align="left">86403</td>
<td align="left">YES</td>
<td align="left">PUBLIC</td>
<td align="right">69</td>
<td align="right">67</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">522</td>
<td align="left">590014800009</td>
<td align="left">MANY FARMS COMMUNITY SCHOOL, INC</td>
<td align="left">MANY FARMS</td>
<td align="left">APACHE</td>
<td align="left">86538</td>
<td align="left">NO</td>
<td align="left">PUBLIC</td>
<td align="right">38</td>
<td align="right">38</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">785</td>
<td align="left">NA</td>
<td align="left">ST THERESA LITTLE FLOWER PRESCHOOL</td>
<td align="left">PHOENIX</td>
<td align="left">MARICOPA</td>
<td align="left">85018</td>
<td align="left">YES</td>
<td align="left">PUBLIC</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">821</td>
<td align="left">NA</td>
<td align="left">T.U.S.D.#1 - C. E. ROSE PRESCHOOL PROGRAM</td>
<td align="left">TUCSON</td>
<td align="left">PIMA</td>
<td align="left">85714</td>
<td align="left">YES</td>
<td align="left">PUBLIC</td>
<td align="right">86</td>
<td align="right">86</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<p>In real life, you’d have to decide how much you care about these missing schools – does it ruin your story, or can you just mention that you were unable to get information for a handful of schools, amounting to about 350 students?</p>
<div id="use-the-joined-table" class="section level4 unnumbered">
<h4>Use the joined table</h4>
<p>Now I might want to look at which school districts have low immunization rates:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">immune_joined <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="st">  </span><span class="co"># by school </span></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="st">  </span><span class="kw">mutate</span> (<span class="dt">school_pct =</span> num_immune_mmr <span class="op">/</span><span class="st"> </span>enrolled  <span class="op">*</span><span class="st"> </span><span class="dv">100</span> ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-4" title="4"><span class="st">  </span><span class="co"># by district</span></a>
<a class="sourceLine" id="cb76-5" title="5"><span class="st">  </span><span class="kw">group_by</span> (nces_district_name, county) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-6" title="6"><span class="st">  </span><span class="kw">summarise</span> ( <span class="dt">num_schools =</span> <span class="kw">n</span>() ,</a>
<a class="sourceLine" id="cb76-7" title="7">              <span class="dt">total_enrolled =</span> <span class="kw">sum</span>(enrolled),</a>
<a class="sourceLine" id="cb76-8" title="8">              <span class="dt">total_immune =</span> <span class="kw">sum</span> (num_immune_mmr),</a>
<a class="sourceLine" id="cb76-9" title="9">              <span class="dt">median_immune =</span> <span class="kw">median</span> (school_pct)</a>
<a class="sourceLine" id="cb76-10" title="10">              ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-11" title="11"><span class="st">  </span><span class="co"># district total pct (immunized / total students)</span></a>
<a class="sourceLine" id="cb76-12" title="12"><span class="st">  </span><span class="kw">mutate</span> ( <span class="dt">pct_immune =</span> total_immune<span class="op">/</span><span class="st"> </span>total_enrolled <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-13" title="13"><span class="st">  </span><span class="kw">select</span> (nces_district_name, county, num_schools, pct_immune, total_enrolled,  median_immune) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-14" title="14"><span class="st">  </span><span class="kw">filter</span> (median_immune <span class="op">&lt;=</span><span class="st"> </span><span class="dv">93</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-15" title="15"><span class="st">  </span><span class="kw">head</span> (<span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-16" title="16"><span class="st">  </span><span class="kw">kable</span> (<span class="dt">digits=</span><span class="dv">1</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">nces_district_name</th>
<th align="left">county</th>
<th align="right">num_schools</th>
<th align="right">pct_immune</th>
<th align="right">total_enrolled</th>
<th align="right">median_immune</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Acclaim Charter School</td>
<td align="left">MARICOPA</td>
<td align="right">1</td>
<td align="right">88.6</td>
<td align="right">44</td>
<td align="right">88.6</td>
</tr>
<tr class="even">
<td align="left">American Leadership Academy Inc.</td>
<td align="left">MARICOPA</td>
<td align="right">5</td>
<td align="right">91.9</td>
<td align="right">467</td>
<td align="right">92.9</td>
</tr>
<tr class="odd">
<td align="left">Arete Preparatory Academy</td>
<td align="left">MARICOPA</td>
<td align="right">1</td>
<td align="right">90.9</td>
<td align="right">99</td>
<td align="right">90.9</td>
</tr>
<tr class="even">
<td align="left">Arizona Connections Academy Charter School Inc.</td>
<td align="left">MARICOPA</td>
<td align="right">1</td>
<td align="right">85.6</td>
<td align="right">201</td>
<td align="right">85.6</td>
</tr>
<tr class="odd">
<td align="left">Arizona Montessori Charter School at Anthem</td>
<td align="left">MARICOPA</td>
<td align="right">1</td>
<td align="right">86.5</td>
<td align="right">37</td>
<td align="right">86.5</td>
</tr>
<tr class="even">
<td align="left">Ball Charter Schools (Dobson)</td>
<td align="left">MARICOPA</td>
<td align="right">1</td>
<td align="right">90.0</td>
<td align="right">40</td>
<td align="right">90.0</td>
</tr>
<tr class="odd">
<td align="left">BASIS School Inc. 12</td>
<td align="left">YAVAPAI</td>
<td align="right">1</td>
<td align="right">85.7</td>
<td align="right">91</td>
<td align="right">85.7</td>
</tr>
<tr class="even">
<td align="left">BASIS School Inc. 6</td>
<td align="left">COCONINO</td>
<td align="right">1</td>
<td align="right">92.6</td>
<td align="right">95</td>
<td align="right">92.6</td>
</tr>
<tr class="odd">
<td align="left">BASIS School Inc. 9</td>
<td align="left">MARICOPA</td>
<td align="right">1</td>
<td align="right">91.7</td>
<td align="right">133</td>
<td align="right">91.7</td>
</tr>
<tr class="even">
<td align="left">Benchmark School Inc.</td>
<td align="left">MARICOPA</td>
<td align="right">1</td>
<td align="right">85.5</td>
<td align="right">55</td>
<td align="right">85.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="resources-2" class="section level2">
<h2><span class="header-section-number">8.4</span> Resources</h2>
<ul>
<li>The “<a href="https://r4ds.had.co.nz/relational-data.html">Relational data</a>” chapter in the R for Data Science textbook has details on exactly how a complex data set might fit together.</li>
<li><a href="https://stat545.com/join-cheatsheet.html#left_joinsuperheroes-publishers">An example using a famous superheroes dataset</a>, from Stat 545 at the University of British Columbia</li>
</ul>
<div id="practice" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Practice</h3>
<div id="immunization-data" class="section level4 unnumbered">
<h4>Immunization data</h4>
<p>Create a new table from the immunizations and DOE data used in this example, then see if you can find any patterns in immunization rates by school district rather than by county. (Note that charter school companies are each their own district.) Do the same by looking at urban vs. rural schools.</p>
</div>
<div id="campaign-finance-data" class="section level4 unnumbered">
<h4>Campaign finance data</h4>
<p>There are two tables saved in the R data file, “<a href="https://github.com/cronkitedata/rstudyguide/blob/master/data/azcampfin.Rda?raw=true">azcampfin.Rda</a>”. One holds information on contributions available from the offiical FEC database as of Feb. 23, 2020 and the other holds information on the candidates and committees.</p>
<p>The following codes are used in this dataset, which you may want to save into data frame. Here is some code you can use to create a lookup table for the transaction types. These codes can be joined with the column called <code>transaction_tp</code> in the contributions (or <code>arizona20</code>) data frame.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">transaction_types &lt;-<span class="st"> </span><span class="kw">tribble</span> (</a>
<a class="sourceLine" id="cb77-2" title="2">  <span class="op">~</span>tcode, <span class="op">~</span>contrib_type,</a>
<a class="sourceLine" id="cb77-3" title="3">  <span class="st">&quot;10&quot;</span>,   <span class="st">&quot;To a Super PAC&quot;</span>,</a>
<a class="sourceLine" id="cb77-4" title="4">  <span class="st">&quot;11&quot;</span>,   <span class="st">&quot;Native American tribal&quot;</span>,</a>
<a class="sourceLine" id="cb77-5" title="5">  <span class="st">&quot;15&quot;</span>,   <span class="st">&quot;Individual contrib&quot;</span>,</a>
<a class="sourceLine" id="cb77-6" title="6">  <span class="st">&quot;15C&quot;</span>,  <span class="st">&quot;From a candidate&quot;</span>,</a>
<a class="sourceLine" id="cb77-7" title="7">  <span class="st">&quot;15E&quot;</span>,  <span class="st">&quot;Earmarked (eg, ActBlue)&quot;</span>,</a>
<a class="sourceLine" id="cb77-8" title="8">  <span class="st">&quot;20Y&quot;</span>,  <span class="st">&quot;Non-federal refund&quot;</span>,</a>
<a class="sourceLine" id="cb77-9" title="9">  <span class="st">&quot;22Y&quot;</span>,  <span class="st">&quot;Refund to indiv.&quot;</span>,</a>
<a class="sourceLine" id="cb77-10" title="10">  <span class="st">&quot;24I&quot;</span>,  <span class="st">&quot;Earmarked check passed on&quot;</span>,</a>
<a class="sourceLine" id="cb77-11" title="11">  <span class="st">&quot;24T&quot;</span>,  <span class="st">&quot;Earmarked contrib passed on&quot;</span>,</a>
<a class="sourceLine" id="cb77-12" title="12">  <span class="st">&quot;30&quot;</span>,   <span class="st">&quot;To a convention account&quot;</span>,</a>
<a class="sourceLine" id="cb77-13" title="13">  <span class="st">&quot;31&quot;</span>,   <span class="st">&quot;To a headquarters account&quot;</span>,</a>
<a class="sourceLine" id="cb77-14" title="14">  <span class="st">&quot;32&quot;</span>,   <span class="st">&quot;To a recount effort&quot;</span>,</a>
<a class="sourceLine" id="cb77-15" title="15">  <span class="st">&quot;41Y&quot;</span>,   <span class="st">&quot;Refund from headquarters account&quot;</span></a>
<a class="sourceLine" id="cb77-16" title="16">  )</a></code></pre></div>
<p>(These are pretty complicated definitions in the federal campaign finance world. For now, don’t worry much about what they mean. Refunds are shown in the data as negative numbers, which is what you want.)</p>
<p>Try to analyze some of this by putting together the datasets and finding interesting items or patterns.</p>

<!-- Add link to the drag queen coding class. See if there are other good first-day programming aides I should add.-->
</div>
</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="035-mutate.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="A02-programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "github"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 2
});
});
</script>

</body>

</html>
