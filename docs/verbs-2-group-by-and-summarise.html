<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter5 Verbs 2: group_by and summarise | book-example.utf8.md</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter5 Verbs 2: group_by and summarise | book-example.utf8.md" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter5 Verbs 2: group_by and summarise | book-example.utf8.md" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="verbs-1-select-and-filter.html"/>
<link rel="next" href="verbs-3-mutate.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Study Guide for Cronkite Students</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html"><i class="fa fa-check"></i><b>1</b> R an R Studio tour</a><ul>
<li class="chapter" data-level="1.1" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#key-takeaways"><i class="fa fa-check"></i><b>1.1</b> Key takeaways</a></li>
<li class="chapter" data-level="1.2" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#why-program"><i class="fa fa-check"></i><b>1.2</b> Why program?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#why-r"><i class="fa fa-check"></i><b>1.2.1</b> Why R?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#setting-up-r-and-r-studio"><i class="fa fa-check"></i><b>1.3</b> Setting up R and R Studio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#rstudio-cloud"><i class="fa fa-check"></i><b>1.3.1</b> RStudio Cloud</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#install-yourself"><i class="fa fa-check"></i><b>1.3.2</b> Install yourself</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#an-r-studio-tour"><i class="fa fa-check"></i><b>1.3.3</b> An R Studio tour</a></li>
<li class="chapter" data-level="1.3.4" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#the-console"><i class="fa fa-check"></i><b>1.3.4</b> The Console</a></li>
<li class="chapter" data-level="1.3.5" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#packages"><i class="fa fa-check"></i><b>1.3.5</b> Packages</a></li>
<li class="chapter" data-level="1.3.6" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#work-in-projects"><i class="fa fa-check"></i><b>1.3.6</b> Work in projects</a></li>
<li class="chapter" data-level="1.3.7" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#error-messages"><i class="fa fa-check"></i><b>1.3.7</b> Error messages</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#resources-and-exercises"><i class="fa fa-check"></i><b>1.4</b> Resources and exercises</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#take-the-swirl-tutorial"><i class="fa fa-check"></i><b>1.4.1</b> Take the swirl() tutorial</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#programming-concepts"><i class="fa fa-check"></i><b>1.4.2</b> Programming concepts</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-an-r-studio-tour.html"><a href="r-an-r-studio-tour.html#r-and-r-studio"><i class="fa fa-check"></i><b>1.4.3</b> R and R Studio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>2</b> R Markdown</a><ul>
<li class="chapter" data-level="2.1" data-path="r-markdown.html"><a href="r-markdown.html#key-takeaways-1"><i class="fa fa-check"></i><b>2.1</b> Key takeaways</a></li>
<li class="chapter" data-level="2.2" data-path="r-markdown.html"><a href="r-markdown.html#understanding-markdown"><i class="fa fa-check"></i><b>2.2</b> Understanding Markdown</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r-markdown.html"><a href="r-markdown.html#formatting-in-markdown"><i class="fa fa-check"></i><b>2.2.1</b> Formatting in Markdown</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-markdown.html"><a href="r-markdown.html#code-chunks"><i class="fa fa-check"></i><b>2.2.2</b> Code chunks</a></li>
<li class="chapter" data-level="2.2.3" data-path="r-markdown.html"><a href="r-markdown.html#viewing-your-document"><i class="fa fa-check"></i><b>2.2.3</b> Viewing your document</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-markdown.html"><a href="r-markdown.html#resources"><i class="fa fa-check"></i><b>2.3</b> Resources</a><ul>
<li class="chapter" data-level="2.3.1" data-path="r-markdown.html"><a href="r-markdown.html#exercises-and-assignments"><i class="fa fa-check"></i><b>2.3.1</b> Exercises and assignments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-frames-and-the-tidyverse.html"><a href="data-frames-and-the-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Data frames and the tidyverse</a><ul>
<li class="chapter" data-level="3.1" data-path="data-frames-and-the-tidyverse.html"><a href="data-frames-and-the-tidyverse.html#key-takeaways-2"><i class="fa fa-check"></i><b>3.1</b> Key takeaways</a></li>
<li class="chapter" data-level="3.2" data-path="data-frames-and-the-tidyverse.html"><a href="data-frames-and-the-tidyverse.html#data-frames"><i class="fa fa-check"></i><b>3.2</b> Data frames</a></li>
<li class="chapter" data-level="3.3" data-path="data-frames-and-the-tidyverse.html"><a href="data-frames-and-the-tidyverse.html#the-tidyverse"><i class="fa fa-check"></i><b>3.3</b> The tidyverse</a></li>
<li class="chapter" data-level="3.4" data-path="data-frames-and-the-tidyverse.html"><a href="data-frames-and-the-tidyverse.html#loading-data"><i class="fa fa-check"></i><b>3.4</b> Loading data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-frames-and-the-tidyverse.html"><a href="data-frames-and-the-tidyverse.html#column-names"><i class="fa fa-check"></i><b>3.4.1</b> Column names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html"><i class="fa fa-check"></i><b>4</b> Verbs 1: Select and filter</a><ul>
<li class="chapter" data-level="4.1" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#key-takeaways-3"><i class="fa fa-check"></i><b>4.1</b> Key takeaways</a></li>
<li class="chapter" data-level="4.2" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#load-the-tidyverse-and-the-data"><i class="fa fa-check"></i><b>4.2</b> Load the tidyverse and the data</a></li>
<li class="chapter" data-level="4.3" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#create-a-new-data-frame-from-an-old-one"><i class="fa fa-check"></i><b>4.3</b> Create a new data frame from an old one</a></li>
<li class="chapter" data-level="4.4" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#select---choosing-columns"><i class="fa fa-check"></i><b>4.4</b> Select - choosing columns</a><ul>
<li class="chapter" data-level="4.4.1" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#optional-other-ways-to-select"><i class="fa fa-check"></i><b>4.4.1</b> Optional: Other ways to select</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#filter---choosing-rows"><i class="fa fa-check"></i><b>4.5</b> Filter - choosing rows</a><ul>
<li class="chapter" data-level="4.5.1" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#one-filter"><i class="fa fa-check"></i><b>4.5.1</b> One filter</a></li>
<li class="chapter" data-level="4.5.2" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#a-compound-filter"><i class="fa fa-check"></i><b>4.5.2</b> A compound filter</a></li>
<li class="chapter" data-level="4.5.3" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#an-even-more-compound-filter"><i class="fa fa-check"></i><b>4.5.3</b> An even more compound filter</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#arrange---change-the-order"><i class="fa fa-check"></i><b>4.6</b> Arrange - change the order</a></li>
<li class="chapter" data-level="4.7" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#traps"><i class="fa fa-check"></i><b>4.7</b> Traps</a><ul>
<li class="chapter" data-level="4.7.1" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#case-sensitivity"><i class="fa fa-check"></i><b>4.7.1</b> Case-sensitivity</a></li>
<li class="chapter" data-level="4.7.2" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#equals-versus-double-equals"><i class="fa fa-check"></i><b>4.7.2</b> Equals versus double-equals</a></li>
<li class="chapter" data-level="4.7.3" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#forgetting-the-and-then-operator"><i class="fa fa-check"></i><b>4.7.3</b> Forgetting the “and then” operator (%&gt;%)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#resources-1"><i class="fa fa-check"></i><b>4.8</b> Resources</a><ul>
<li class="chapter" data-level="4.8.1" data-path="verbs-1-select-and-filter.html"><a href="verbs-1-select-and-filter.html#tutorials"><i class="fa fa-check"></i><b>4.8.1</b> Tutorials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="verbs-2-group-by-and-summarise.html"><a href="verbs-2-group-by-and-summarise.html"><i class="fa fa-check"></i><b>5</b> Verbs 2: group_by and summarise</a><ul>
<li class="chapter" data-level="5.1" data-path="verbs-2-group-by-and-summarise.html"><a href="verbs-2-group-by-and-summarise.html#key-takeaways-4"><i class="fa fa-check"></i><b>5.1</b> Key takeaways</a></li>
<li class="chapter" data-level="5.2" data-path="verbs-2-group-by-and-summarise.html"><a href="verbs-2-group-by-and-summarise.html#read-in-some-data"><i class="fa fa-check"></i><b>5.2</b> Read in some data</a></li>
<li class="chapter" data-level="5.3" data-path="verbs-2-group-by-and-summarise.html"><a href="verbs-2-group-by-and-summarise.html#group_by-summarise-verbs"><i class="fa fa-check"></i><b>5.3</b> group_by / summarise () verbs</a><ul>
<li class="chapter" data-level="5.3.1" data-path="verbs-2-group-by-and-summarise.html"><a href="verbs-2-group-by-and-summarise.html#summarizing-data-with-group_by"><i class="fa fa-check"></i><b>5.3.1</b> Summarizing data with group_by</a></li>
<li class="chapter" data-level="5.3.2" data-path="verbs-2-group-by-and-summarise.html"><a href="verbs-2-group-by-and-summarise.html#another-example-by-state"><i class="fa fa-check"></i><b>5.3.2</b> Another example: by state</a></li>
<li class="chapter" data-level="5.3.3" data-path="verbs-2-group-by-and-summarise.html"><a href="verbs-2-group-by-and-summarise.html#optional-subtotals"><i class="fa fa-check"></i><b>5.3.3</b> Optional: Subtotals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="verbs-2-group-by-and-summarise.html"><a href="verbs-2-group-by-and-summarise.html#resources-2"><i class="fa fa-check"></i><b>5.4</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="verbs-3-mutate.html"><a href="verbs-3-mutate.html"><i class="fa fa-check"></i><b>6</b> Verbs 3: mutate</a><ul>
<li class="chapter" data-level="6.1" data-path="verbs-3-mutate.html"><a href="verbs-3-mutate.html#key-takeaways-5"><i class="fa fa-check"></i><b>6.1</b> Key takeaways</a></li>
<li class="chapter" data-level="6.2" data-path="verbs-3-mutate.html"><a href="verbs-3-mutate.html#read-in-some-data-1"><i class="fa fa-check"></i><b>6.2</b> Read in some data</a></li>
<li class="chapter" data-level="6.3" data-path="verbs-3-mutate.html"><a href="verbs-3-mutate.html#simple-arithmetic"><i class="fa fa-check"></i><b>6.3</b> Simple arithmetic</a></li>
<li class="chapter" data-level="6.4" data-path="verbs-3-mutate.html"><a href="verbs-3-mutate.html#create-categories"><i class="fa fa-check"></i><b>6.4</b> Create categories</a></li>
<li class="chapter" data-level="6.5" data-path="verbs-3-mutate.html"><a href="verbs-3-mutate.html#standardize-data"><i class="fa fa-check"></i><b>6.5</b> Standardize data</a></li>
<li class="chapter" data-level="6.6" data-path="verbs-3-mutate.html"><a href="verbs-3-mutate.html#resources-3"><i class="fa fa-check"></i><b>6.6</b> Resources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="verbs-2-group_by-and-summarise" class="section level1">
<h1><span class="header-section-number">Chapter5</span> Verbs 2: group_by and summarise</h1>
<div id="key-takeaways-4" class="section level2">
<h2><span class="header-section-number">5.1</span> Key takeaways</h2>
<ul>
<li><em>group_by</em> creates one row for every identical value of a variable.</li>
<li><em>summarise</em> calculates summary statistics for each of those values.</li>
<li>You will rarely use group_by <em>without</em> summarise()</li>
<li>These queries answer the questions, “How many”, and “how much?”</li>
<li>If your data is not standardized, you will get many, many groups that might not make sense. That is, if a variable sometimes says “Lettuce” and sometimes says “Lettuce - Romaine”, they will be different groups. If a variable has “Pistol” in one row and “pistol” in another, they will also be different groups.</li>
</ul>
</div>
<div id="read-in-some-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Read in some data</h2>
<p>We’ve read the Serial Killer Detective from the New Yorker in class. The project makes the dataset public, and Andrew Ba Tran uses the entire country’s data in his online course at <a href="https://learn.r-journalism.com/en/">R for Journalists</a>. I’ve taken that dataset, made it a little simpler and pulled out just the Arizona cases.</p>
<p>NOTE: My apologies – This dataset has slightly different variable names and types than the one we worked with in filtering. I’ll go back and try to fix it but don’t be surprised if it’s just a little different. For example, I don’t have the weapon or relationship codes in this one.</p>
<p>As always, load the tidyverse</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>And load a dataset saved in native R format from our course website:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">load</span> (<span class="kw">url</span>(<span class="st">&quot;https://cronkitedata.github.io/cronkite-docs/assets/data/r-data/murders.Rda&quot;</span>))</a>
<a class="sourceLine" id="cb38-2" title="2"></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="co">#print out the structure of the dataset</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="kw">str</span>(murders)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    29655 obs. of  18 variables:
##  $ id                    : Factor w/ 719011 levels &quot;197601001AKASP00&quot;,..: 41 42 43 44 45 46 47 48 49 50 ...
##  $ cntyfips              : num  4005 4013 4013 4013 4013 ...
##  $ ori                   : Factor w/ 12616 levels &quot;AK00101&quot;,&quot;AK00102&quot;,..: 570 586 589 590 593 595 598 620 642 650 ...
##  $ state                 : Factor w/ 54 levels &quot;Alaska&quot;,&quot;Alabama&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ agency                : chr  &quot;Flagstaff&quot; &quot;Maricopa County&quot; &quot;Chandler&quot; &quot;El Mirage&quot; ...
##  $ agency_type           : Factor w/ 8 levels &quot;Sheriff&quot;,&quot;County police&quot;,..: 3 1 3 3 3 3 3 3 3 3 ...
##  $ solved                : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 1 2 2 2 2 2 2 1 2 ...
##  $ year                  : num  1976 1976 1976 1976 1976 ...
##  $ situation             : Factor w/ 6 levels &quot;Single victim/single offender&quot;,..: 1 2 1 1 1 1 1 1 2 1 ...
##  $ victim_age            : num  1 18 19 20 43 0 38 26 67 58 ...
##  $ victim_sex            : Factor w/ 3 levels &quot;Female&quot;,&quot;Male&quot;,..: 2 1 2 2 2 1 2 2 2 2 ...
##  $ victim_race           : Factor w/ 5 levels &quot;Asian or Pacific Islander&quot;,..: 5 5 5 2 5 5 5 2 5 5 ...
##  $ weapon                : Factor w/ 17 levels &quot;Firearm, type not stated&quot;,..: 8 6 2 2 6 8 2 4 12 4 ...
##  $ circumstance          : Factor w/ 32 levels &quot;Rape&quot;,&quot;Robbery&quot;,..: 28 32 30 18 29 11 18 31 6 18 ...
##  $ vic_relate_to_offender: Factor w/ 29 levels &quot;Acquaintance&quot;,..: 24 26 25 2 12 6 5 25 26 12 ...
##  $ offender_age          : num  20 999 51 24 32 19 44 27 999 29 ...
##  $ offender_sex          : Factor w/ 3 levels &quot;Female&quot;,&quot;Male&quot;,..: 2 3 2 1 2 1 1 2 3 2 ...
##  $ offender_race         : Factor w/ 5 levels &quot;Asian or Pacific Islander&quot;,..: 5 4 5 2 2 5 5 5 4 5 ...</code></pre>
</div>
<div id="group_by-summarise-verbs" class="section level2">
<h2><span class="header-section-number">5.3</span> group_by / summarise () verbs</h2>
<p>Group_by and summarise () almost always go together, the way that a pivot always has one element in the row or column area, and another element that produces the numbers in middle. In fact, almost everything we’ve done so far has a corrollary in an Excel data sheet or pivot table:</p>
<div class="figure">
<img src="images/21-excel-to-groupby.png" alt="xl-to-groupby" />
<p class="caption">xl-to-groupby</p>
</div>
<div id="summarizing-data-with-group_by" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Summarizing data with group_by</h3>
<p>Group by is used when you want to answer questions that start with “How many?” and “How much?” . They <em>summarize</em> your data to a new unit of analysis that is more general than the data you started with.</p>
<p>Think of it as making piles of cards by suit, or gathering together all the red M&amp;Ms, all the brown ones, and all the other colors into their own little areas, then counting up how many are in each pile.</p>
<p>A group by statement is almost always followed by a “summarise” (British spelling) statement, that supplies the <em>number</em> you want to calculate. Give the number a name you’ll recognize later so that it’s easy to refer back to:</p>
<pre><code>      summarise ( number_of_items =  n () ,
                  total_amount = sum ( my_variable, na.rm = TRUE), 
                  number_of_unique_items = n_distinct (my_variable) )
      </code></pre>
<p>You can also get the minimum value, maximum value, average, median, etc. One advantage of R over Excel is that you can get medians by groups in R – something that’s quite difficult in Excel.</p>
<p>One common task is to look at which categories are largest in a dataset:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">murders <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="st">  </span><span class="kw">group_by</span> ( weapon ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="st">  </span><span class="kw">summarise</span> ( <span class="dt">num_of_murders =</span> <span class="kw">n</span>() ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="st">  </span><span class="kw">arrange</span>  ( <span class="kw">desc</span>(num_of_murders) )</a></code></pre></div>
<pre><code>## # A tibble: 17 x 2
##    weapon                               num_of_murders
##    &lt;fct&gt;                                         &lt;int&gt;
##  1 Handgun - pistol, revolver, etc               13772
##  2 Knife or cutting instrument                    4402
##  3 Personal weapons, includes beating             1891
##  4 Blunt object - hammer, club, etc               1872
##  5 Rifle                                          1764
##  6 Firearm, type not stated                       1565
##  7 Other or type unknown                          1407
##  8 Shotgun                                        1256
##  9 Strangulation - hanging                         668
## 10 Asphyxiation - includes death by gas            312
## 11 Fire                                            250
## 12 Narcotics or drugs, sleeping pills              174
## 13 Other gun                                       136
## 14 Drowning                                        117
## 15 Poison - does not include gas                    32
## 16 Explosives                                       20
## 17 Pushed or thrown out window                      17</code></pre>
<p>You can group by more than one variable. For instance, I may want to look at weapon useage by state:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">murders <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="st">  </span><span class="kw">group_by</span> (weapon,  state) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="st">  </span><span class="kw">summarise</span> (<span class="dt">num_of_murders =</span> <span class="kw">n</span>() )  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="st">  </span><span class="kw">arrange</span> ( weapon, state )</a></code></pre></div>
<pre><code>## # A tibble: 67 x 3
## # Groups:   weapon [17]
##    weapon                          state      num_of_murders
##    &lt;fct&gt;                           &lt;fct&gt;               &lt;int&gt;
##  1 Firearm, type not stated        Arizona               742
##  2 Firearm, type not stated        Idaho                  62
##  3 Firearm, type not stated        Oregon                368
##  4 Firearm, type not stated        Washington            393
##  5 Handgun - pistol, revolver, etc Arizona              7826
##  6 Handgun - pistol, revolver, etc Idaho                 531
##  7 Handgun - pistol, revolver, etc Oregon               1650
##  8 Handgun - pistol, revolver, etc Washington           3765
##  9 Rifle                           Arizona               698
## 10 Rifle                           Idaho                 157
## # … with 57 more rows</code></pre>
</div>
<div id="another-example-by-state" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Another example: by state</h3>
<p>Here are some other examples of data you can calculate, this time by state :</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">murders <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="st">  </span><span class="kw">group_by</span> (state) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="st">  </span><span class="kw">summarise</span> (<span class="dt">num_of_murders =</span> <span class="kw">n</span>() ,</a>
<a class="sourceLine" id="cb45-4" title="4">             <span class="dt">num_of_agencies =</span> <span class="kw">n_distinct</span> (agency),</a>
<a class="sourceLine" id="cb45-5" title="5">             <span class="dt">first_murder =</span> <span class="kw">min</span>(year) ,</a>
<a class="sourceLine" id="cb45-6" title="6">             <span class="dt">last_murder =</span> <span class="kw">max</span>(year),</a>
<a class="sourceLine" id="cb45-7" title="7">             <span class="dt">avg_victim_age =</span> <span class="kw">mean</span>(victim_age, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb45-8" title="8">             )</a></code></pre></div>
<pre><code>## # A tibble: 4 x 6
##   state num_of_murders num_of_agencies first_murder last_murder
##   &lt;fct&gt;          &lt;int&gt;           &lt;int&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 Ariz…          14484             101         1976        2016
## 2 Idaho           1430             103         1976        2016
## 3 Oreg…           4850             186         1976        2016
## 4 Wash…           8891             210         1976        2016
## # … with 1 more variable: avg_victim_age &lt;dbl&gt;</code></pre>
</div>
<div id="optional-subtotals" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Optional: Subtotals</h3>
<p>R has powerful ways to look at data with group by commands, including calculating subtotals from a grouped query. Here’s an example, in which we calculate the total number of murders next to the murder by weapon:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">murders <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="st">  </span><span class="kw">group_by</span> (state, weapon) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="st">  </span><span class="kw">summarise</span> (<span class="dt">num_of_murders =</span> <span class="kw">n</span>() ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="st">  </span><span class="co"># this is a new verb you haven&#39;t seen yet! </span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="st">  </span><span class="kw">mutate</span>  ( <span class="dt">num_murders_in_state  =</span> <span class="kw">sum</span>(num_of_murders) ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-6" title="6"><span class="st">  </span><span class="kw">arrange</span> ( weapon)</a></code></pre></div>
<pre><code>## # A tibble: 67 x 4
## # Groups:   state [4]
##    state      weapon                     num_of_murders num_murders_in_sta…
##    &lt;fct&gt;      &lt;fct&gt;                               &lt;int&gt;               &lt;int&gt;
##  1 Arizona    Firearm, type not stated              742               14484
##  2 Idaho      Firearm, type not stated               62                1430
##  3 Oregon     Firearm, type not stated              368                4850
##  4 Washington Firearm, type not stated              393                8891
##  5 Arizona    Handgun - pistol, revolve…           7826               14484
##  6 Idaho      Handgun - pistol, revolve…            531                1430
##  7 Oregon     Handgun - pistol, revolve…           1650                4850
##  8 Washington Handgun - pistol, revolve…           3765                8891
##  9 Arizona    Rifle                                 698               14484
## 10 Idaho      Rifle                                 157                1430
## # … with 57 more rows</code></pre>
</div>
</div>
<div id="resources-2" class="section level2">
<h2><span class="header-section-number">5.4</span> Resources</h2>
<ul>
<li>Andrew Ba Tran’s “R for Journalists”, bottom of chapter 3, “<a href="https://learn.r-journalism.com/en/wrangling/dplyr/dplyr/">Wrangling data</a>”<br />
</li>
<li>Mary Jo Webster’s “<a href="https://mjwebster.github.io/DataJ/R/IntroAnalysisWithR.html">Intro to analysis with Tidyverse</a>” is a walkthrough aimed at group by / summarise.</li>
<li>Go back to Pivot Tables in Excel - it’s the same thing.</li>
<li>Susan Baert’s dplyr tutorial: <a href="https://suzan.rbind.io/2018/04/dplyr-tutorial-4/">summarizing data</a></li>
<li>Matt Waite’s “<a href="http://mattwaite.github.io/sports/aggregates.html">Aggregates</a>” chapter</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="verbs-1-select-and-filter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="verbs-3-mutate.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
